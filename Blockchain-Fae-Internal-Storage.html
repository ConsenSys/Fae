<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Blockchain.Fae.Internal.Storage</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Blockchain.Fae.Internal.Storage.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">fae-1.0.1.0</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Ryan Reich 2017-2018</td></tr><tr><th>License</th><td>MIT</td></tr><tr><th>Maintainer</th><td>ryan.reich@gmail.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Blockchain.Fae.Internal.Storage</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Types</a></li><li><a href="#g:2">Template Haskell</a></li><li><a href="#g:3">Functions</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module provides the <code><a href="Blockchain-Fae-Internal-Storage.html#t:FaeStorageT">FaeStorageT</a></code> monad family, which tracks the state of Fae as contracts execute.  All the types here are parametrized over an unconstrained parameter <code>c</code>, but only <code>AbstractContract</code> is ever used.  This indirection is necessary to avert an import cycle between this module and <a href="Blockchain-Fae-Internal-Contract.html">Blockchain.Fae.Internal.Contract</a>.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">newtype</span> <a href="#t:StorageT">StorageT</a> c = <a href="#v:Storage">Storage</a> {<ul class="subs"><li><a href="#v:getStorage">getStorage</a> :: <a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c)</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:TransactionEntryT">TransactionEntryT</a> c = <a href="#v:TransactionEntry">TransactionEntry</a> {<ul class="subs"><li><a href="#v:inputOutputs">inputOutputs</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputsT">InputOutputsT</a> c</li><li><a href="#v:inputOrder">inputOrder</a> :: [<a href="Blockchain-Fae-Internal-IDs-Types.html#t:ShortContractID">ShortContractID</a>]</li><li><a href="#v:outputs">outputs</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c</li><li><a href="#v:signers">signers</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a></li><li><a href="#v:result">result</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:Result">Result</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:Result">Result</a> = <a href="../base-4.10.0.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="#v:Result">Result</a> a</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:InputOutputsT">InputOutputsT</a> c = <a href="#v:InputOutputs">InputOutputs</a> {<ul class="subs"><li><a href="#v:getInputOutputs">getInputOutputs</a> :: <a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ShortContractID">ShortContractID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c)</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:InputOutputVersionsT">InputOutputVersionsT</a> c = <a href="#v:InputOutputVersions">InputOutputVersions</a> {<ul class="subs"><li><a href="#v:iRealID">iRealID</a> :: <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ContractID">ContractID</a></li><li><a href="#v:iOutputs">iOutputs</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c</li><li><a href="#v:iVersions">iVersions</a> :: <a href="Blockchain-Fae-Internal-Versions.html#t:VersionRepMap">VersionRepMap</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:OutputsT">OutputsT</a> c = <a href="#v:OutputsT">OutputsT</a> {<ul class="subs"><li><a href="#v:outputMap">outputMap</a> :: <a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (c, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>)</li><li><a href="#v:outputCount">outputCount</a> :: <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a></li></ul>}</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:Signers">Signers</a> = <a href="#v:Signers">Signers</a> {<ul class="subs"><li><a href="#v:getSigners">getSigners</a> :: <a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="../base-4.10.0.0/Data-String.html#t:String">String</a> <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a></li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:FaeStorageT">FaeStorageT</a> m c = <a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:StateT">StateT</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) m</li><li class="src short"><a href="#v:_getSigners">_getSigners</a> :: <a href="../lens-4.15.4/Control-Lens-Type.html#t:Iso-39-">Iso'</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> (<a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="../base-4.10.0.0/Data-String.html#t:String">String</a> <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a>)</li><li class="src short"><a href="#v:_getStorage">_getStorage</a> :: <span class="keyword">forall</span> c c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Iso">Iso</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) (<a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c)) (<a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c))</li><li class="src short"><a href="#v:_getInputOutputs">_getInputOutputs</a> :: <span class="keyword">forall</span> c c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Iso">Iso</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputsT">InputOutputsT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputsT">InputOutputsT</a> c) (<a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ShortContractID">ShortContractID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c)) (<a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ShortContractID">ShortContractID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c))</li><li class="src short"><a href="#v:_signers">_signers</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c) <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a></li><li class="src short"><a href="#v:_result">_result</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c) <a href="Blockchain-Fae-Internal-Storage.html#t:Result">Result</a></li><li class="src short"><a href="#v:_outputs">_outputs</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c)</li><li class="src short"><a href="#v:_inputOutputs">_inputOutputs</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputsT">InputOutputsT</a> c)</li><li class="src short"><a href="#v:_inputOrder">_inputOrder</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c) [<a href="Blockchain-Fae-Internal-IDs-Types.html#t:ShortContractID">ShortContractID</a>]</li><li class="src short"><a href="#v:_iVersions">_iVersions</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) <a href="Blockchain-Fae-Internal-Versions.html#t:VersionRepMap">VersionRepMap</a></li><li class="src short"><a href="#v:_iRealID">_iRealID</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ContractID">ContractID</a></li><li class="src short"><a href="#v:_iOutputs">_iOutputs</a> :: <span class="keyword">forall</span> c c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens">Lens</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c)</li><li class="src short"><a href="#v:_outputMap">_outputMap</a> :: <span class="keyword">forall</span> c c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens">Lens</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c) (<a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (c, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>)) (<a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (c, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>))</li><li class="src short"><a href="#v:_outputCount">_outputCount</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c) <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:hoistFaeStorage">hoistFaeStorage</a> :: <a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:FaeStorageT">FaeStorageT</a> <a href="Blockchain-Fae.html#t:Identity">Identity</a> c a -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:FaeStorageT">FaeStorageT</a> m c a</li><li class="src short"><a href="#v:nonceAt">nonceAt</a> :: <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ContractID">ContractID</a> -&gt; <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) (<a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (c, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>))</li><li class="src short"><a href="#v:checkNonce">checkNonce</a> :: <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ContractID">ContractID</a> -&gt; <a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (a, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>)) (<a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:nonceSetter">nonceSetter</a> :: <a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (a, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>) -&gt; <a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> a -&gt; <a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (a, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>)</li><li class="src short"><a href="#v:listToOutputs">listToOutputs</a> :: [c] -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c</li><li class="src short"><a href="#v:emptyOutputs">emptyOutputs</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c</li><li class="src short"><a href="#v:combineIOV">combineIOV</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c</li><li class="src short"><a href="#v:combineO">combineO</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c</li></ul></div><div id="interface"><h1 id="g:1">Types</h1><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:StorageT" class="def">StorageT</a> c <a href="src/Blockchain.Fae.Internal.Storage.html#StorageT" class="link">Source</a> <a href="#t:StorageT" class="selflink">#</a></p><div class="doc"><p><code><a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a></code> is just an association between transactions and what they did.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Storage" class="def">Storage</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:getStorage" class="def">getStorage</a> :: <a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c)</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:StorageT" class="caption collapser" onclick="toggleSection('i:StorageT')">Instances</p><div id="section.i:StorageT" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:StorageT:Ixed:1" class="instance expander" onclick="toggleSection('i:id:StorageT:Ixed:1')"></span> <a href="../lens-4.15.4/Control-Lens-At.html#t:Ixed">Ixed</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c)</span> <a href="src/Blockchain.Fae.Internal.Storage.html#line-127" class="link">Source</a> <a href="#t:StorageT" class="selflink">#</a></td><td class="doc"><p>For the <code><a href="../lens-4.15.4/Control-Lens-At.html#t:At">At</a></code> instance</p></td></tr><tr><td colspan="2"><div id="section.i:id:StorageT:Ixed:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:ix">ix</a> :: <a href="../lens-4.15.4/Control-Lens-At.html#t:Index">Index</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) -&gt; <a href="../lens-4.15.4/Control-Lens-Type.html#t:Traversal-39-">Traversal'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) (<a href="../lens-4.15.4/Control-Lens-At.html#t:IxValue">IxValue</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c)) <a href="#v:ix" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:StorageT:At:2" class="instance expander" onclick="toggleSection('i:id:StorageT:At:2')"></span> <a href="../lens-4.15.4/Control-Lens-At.html#t:At">At</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c)</span> <a href="src/Blockchain.Fae.Internal.Storage.html#line-131" class="link">Source</a> <a href="#t:StorageT" class="selflink">#</a></td><td class="doc"><p>We define this instance <em>in addition to</em> the natural <code><a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a></code>
 indexing of a <code><a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a></code> so that we can look up contracts by ID, which
 requires descending to various levels into the maps.</p></td></tr><tr><td colspan="2"><div id="section.i:id:StorageT:At:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:at">at</a> :: <a href="../lens-4.15.4/Control-Lens-At.html#t:Index">Index</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) -&gt; <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) (<a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="../lens-4.15.4/Control-Lens-At.html#t:IxValue">IxValue</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c))) <a href="#v:at" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:StorageT:Index:3" class="instance expander" onclick="toggleSection('i:id:StorageT:Index:3')"></span> <span class="keyword">type</span> <a href="../lens-4.15.4/Control-Lens-At.html#t:Index">Index</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c)</span> <a href="src/Blockchain.Fae.Internal.Storage.html#line-123" class="link">Source</a> <a href="#t:StorageT" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:StorageT:Index:3" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="../lens-4.15.4/Control-Lens-At.html#t:Index">Index</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) = <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ContractID">ContractID</a></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:StorageT:IxValue:4" class="instance expander" onclick="toggleSection('i:id:StorageT:IxValue:4')"></span> <span class="keyword">type</span> <a href="../lens-4.15.4/Control-Lens-At.html#t:IxValue">IxValue</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c)</span> <a href="src/Blockchain.Fae.Internal.Storage.html#line-125" class="link">Source</a> <a href="#t:StorageT" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:StorageT:IxValue:4" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="../lens-4.15.4/Control-Lens-At.html#t:IxValue">IxValue</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) = c</div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TransactionEntryT" class="def">TransactionEntryT</a> c <a href="src/Blockchain.Fae.Internal.Storage.html#TransactionEntryT" class="link">Source</a> <a href="#t:TransactionEntryT" class="selflink">#</a></p><div class="doc"><p>Each transaction can produce outputs in two different ways (cf.
 <code><a href="Blockchain-Fae-Internal-IDs-Types.html#t:ContractID">ContractID</a></code>), has an associated &quot;signer&quot; public key, and a result.</p><p>The technical reason for separating <code><a href="Blockchain-Fae-Internal-Storage.html#v:inputOutputs">inputOutputs</a></code> from <code><a href="Blockchain-Fae-Internal-Storage.html#v:outputs">outputs</a></code> is
 that it makes it possible for contracts to create new contracts without
 putting a global lock on the storage; thunk execution will go straight
 to the correct contract's outputs and not require evaluation of any
 other contract or transaction.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TransactionEntry" class="def">TransactionEntry</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:inputOutputs" class="def">inputOutputs</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputsT">InputOutputsT</a> c</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:inputOrder" class="def">inputOrder</a> :: [<a href="Blockchain-Fae-Internal-IDs-Types.html#t:ShortContractID">ShortContractID</a>]</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:outputs" class="def">outputs</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:signers" class="def">signers</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:result" class="def">result</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:Result">Result</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Result" class="def">Result</a> <a href="src/Blockchain.Fae.Internal.Storage.html#Result" class="link">Source</a> <a href="#t:Result" class="selflink">#</a></p><div class="doc"><p>The result can be anything, but should be <code><a href="../base-4.10.0.0/Text-Show.html#v:show">show</a></code>able so that it has
 outside meaning.  This is an existential type, so the record names are
 just there for documentation; values have to be extracted by
 pattern-matching.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a href="../base-4.10.0.0/Text-Show.html#t:Show">Show</a> a =&gt; <a id="v:Result" class="def">Result</a> a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Result" class="caption collapser" onclick="toggleSection('i:Result')">Instances</p><div id="section.i:Result" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Result:Show:1" class="instance expander" onclick="toggleSection('i:id:Result:Show:1')"></span> <a href="../base-4.10.0.0/Text-Show.html#t:Show">Show</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Result">Result</a></span> <a href="src/Blockchain.Fae.Internal.Storage.html#line-119" class="link">Source</a> <a href="#t:Result" class="selflink">#</a></td><td class="doc"><p>For convenience, so we don't have to pattern-match elsewhere.</p></td></tr><tr><td colspan="2"><div id="section.i:id:Result:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:Result">Result</a> -&gt; <a href="../base-4.10.0.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:Result">Result</a> -&gt; <a href="../base-4.10.0.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Blockchain-Fae-Internal-Storage.html#t:Result">Result</a>] -&gt; <a href="../base-4.10.0.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:InputOutputsT" class="def">InputOutputsT</a> c <a href="src/Blockchain.Fae.Internal.Storage.html#InputOutputsT" class="link">Source</a> <a href="#t:InputOutputsT" class="selflink">#</a></p><div class="doc"><p>Inputs are identified by <code><a href="Blockchain-Fae-Internal-IDs-Types.html#t:ShortContractID">ShortContractID</a></code>s so that <code>ContractIDs</code> of
 the <code><a href="Blockchain-Fae-Internal-IDs-Types.html#v:InputOutput">InputOutput</a></code> variant can be flat, rather than nested potentially
 indefinitely.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:InputOutputs" class="def">InputOutputs</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:getInputOutputs" class="def">getInputOutputs</a> :: <a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ShortContractID">ShortContractID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c)</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:InputOutputVersionsT" class="def">InputOutputVersionsT</a> c <a href="src/Blockchain.Fae.Internal.Storage.html#InputOutputVersionsT" class="link">Source</a> <a href="#t:InputOutputVersionsT" class="selflink">#</a></p><div class="doc"><p>We save the versions map, with the actual values scrubbed, so that it
 can be displayed to learn the actual version IDs.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:InputOutputVersions" class="def">InputOutputVersions</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:iRealID" class="def">iRealID</a> :: <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ContractID">ContractID</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:iOutputs" class="def">iOutputs</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:iVersions" class="def">iVersions</a> :: <a href="Blockchain-Fae-Internal-Versions.html#t:VersionRepMap">VersionRepMap</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:InputOutputVersionsT" class="caption collapser" onclick="toggleSection('i:InputOutputVersionsT')">Instances</p><div id="section.i:InputOutputVersionsT" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:InputOutputVersionsT:Generic:1" class="instance expander" onclick="toggleSection('i:id:InputOutputVersionsT:Generic:1')"></span> <a href="Blockchain-Fae.html#t:Generic">Generic</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c)</span> <a href="src/Blockchain.Fae.Internal.Storage.html#line-85" class="link">Source</a> <a href="#t:InputOutputVersionsT" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:InputOutputVersionsT:Generic:1" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) :: <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> -&gt; <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> <a href="#t:Rep" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c -&gt; <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) x <a href="#v:from" class="selflink">#</a></p><p class="src"><a href="#v:to">to</a> :: <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) x -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c <a href="#v:to" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:InputOutputVersionsT:Rep:2" class="instance expander" onclick="toggleSection('i:id:InputOutputVersionsT:Rep:2')"></span> <span class="keyword">type</span> <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c)</span> <a href="src/Blockchain.Fae.Internal.Storage.html#line-1" class="link">Source</a> <a href="#t:InputOutputVersionsT" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:InputOutputVersionsT:Rep:2" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) = <a href="../base-4.10.0.0/GHC-Generics.html#t:D1">D1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaData">MetaData</a> &quot;InputOutputVersionsT&quot; &quot;Blockchain.Fae.Internal.Storage&quot; &quot;fae-1.0.1.0-5yLYF7GcwlSFBKYFLyDks6&quot; <a href="../base-4.10.0.0/Data-Bool.html#v:False">False</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t:C1">C1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaCons">MetaCons</a> &quot;InputOutputVersions&quot; <a href="../base-4.10.0.0/GHC-Generics.html#v:PrefixI">PrefixI</a> <a href="../base-4.10.0.0/Data-Bool.html#v:True">True</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t::-42-:">(:*:)</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#t:S1">S1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaSel">MetaSel</a> (<a href="../base-4.10.0.0/Data-Maybe.html#v:Just">Just</a> <a href="../base-4.10.0.0/GHC-TypeLits.html#t:Symbol">Symbol</a> &quot;iRealID&quot;) <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceUnpackedness">NoSourceUnpackedness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceStrictness">NoSourceStrictness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:DecidedLazy">DecidedLazy</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t:Rec0">Rec0</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ContractID">ContractID</a>)) (<a href="../base-4.10.0.0/GHC-Generics.html#t::-42-:">(:*:)</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#t:S1">S1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaSel">MetaSel</a> (<a href="../base-4.10.0.0/Data-Maybe.html#v:Just">Just</a> <a href="../base-4.10.0.0/GHC-TypeLits.html#t:Symbol">Symbol</a> &quot;iOutputs&quot;) <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceUnpackedness">NoSourceUnpackedness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceStrictness">NoSourceStrictness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:DecidedLazy">DecidedLazy</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t:Rec0">Rec0</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c))) (<a href="../base-4.10.0.0/GHC-Generics.html#t:S1">S1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaSel">MetaSel</a> (<a href="../base-4.10.0.0/Data-Maybe.html#v:Just">Just</a> <a href="../base-4.10.0.0/GHC-TypeLits.html#t:Symbol">Symbol</a> &quot;iVersions&quot;) <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceUnpackedness">NoSourceUnpackedness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceStrictness">NoSourceStrictness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:DecidedLazy">DecidedLazy</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t:Rec0">Rec0</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> <a href="Blockchain-Fae-Internal-Versions.html#t:VersionRepMap">VersionRepMap</a>)))))</div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:OutputsT" class="def">OutputsT</a> c <a href="src/Blockchain.Fae.Internal.Storage.html#OutputsT" class="link">Source</a> <a href="#t:OutputsT" class="selflink">#</a></p><div class="doc"><p>Outputs are ordered by creation.  However, contracts can be deleted,
 and deletion must preserve the original ordering index of the remaining
 contracts, so it's not enough to just store them in a sequence.  In case
 the outputs of several input calls need to be combined, the original
 count of outputs needs to be retained.  The
 second component of the map entries is the &quot;nonce&quot; of a contract, the
 number of times it has been called, used for security.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:OutputsT" class="def">OutputsT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:outputMap" class="def">outputMap</a> :: <a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (c, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:outputCount" class="def">outputCount</a> :: <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:Signers" class="def">Signers</a> <a href="src/Blockchain.Fae.Internal.Storage.html#Signers" class="link">Source</a> <a href="#t:Signers" class="selflink">#</a></p><div class="doc"><p>Transactions can have many named signatories.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Signers" class="def">Signers</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:getSigners" class="def">getSigners</a> :: <a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="../base-4.10.0.0/Data-String.html#t:String">String</a> <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Signers" class="caption collapser" onclick="toggleSection('i:Signers')">Instances</p><div id="section.i:Signers" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Signers:Generic:1" class="instance expander" onclick="toggleSection('i:id:Signers:Generic:1')"></span> <a href="Blockchain-Fae.html#t:Generic">Generic</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a></span> <a href="src/Blockchain.Fae.Internal.Storage.html#line-102" class="link">Source</a> <a href="#t:Signers" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Signers:Generic:1" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> :: <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> -&gt; <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> <a href="#t:Rep" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> -&gt; <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> x <a href="#v:from" class="selflink">#</a></p><p class="src"><a href="#v:to">to</a> :: <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> x -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> <a href="#v:to" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Signers:Serialize:2" class="instance expander" onclick="toggleSection('i:id:Signers:Serialize:2')"></span> <a href="Blockchain-Fae-Internal-Crypto.html#t:Serialize">Serialize</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a></span> <a href="src/Blockchain.Fae.Internal.Storage.html#line-102" class="link">Source</a> <a href="#t:Signers" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Signers:Serialize:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:put">put</a> :: <a href="../cereal-0.5.4.0/Data-Serialize-Put.html#t:Putter">Putter</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> <a href="#v:put" class="selflink">#</a></p><p class="src"><a href="#v:get">get</a> :: <a href="../cereal-0.5.4.0/Data-Serialize-Get.html#t:Get">Get</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> <a href="#v:get" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Signers:PrettyFae:3" class="instance expander" onclick="toggleSection('i:id:Signers:PrettyFae:3')"></span> <a href="Blockchain-Fae-Internal-PrettyFae.html#t:PrettyFae">PrettyFae</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a></span> <a href="src/Blockchain.Fae.Internal.PrettyFae.html#line-54" class="link">Source</a> <a href="#t:PrettyFae" class="selflink">#</a></td><td class="doc"><ul><li></li></ul></td></tr><tr><td colspan="2"><div id="section.i:id:Signers:PrettyFae:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:prettyFae">prettyFae</a> :: (<a href="../exceptions-0.8.3/Control-Monad-Catch.html#t:MonadCatch">MonadCatch</a> m, <a href="../base-4.10.0.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m) =&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:FaeStorageT">FaeStorageT</a> m c <a href="Blockchain-Fae-Internal-PrettyFae.html#t:VDoc">VDoc</a> <a href="src/Blockchain.Fae.Internal.PrettyFae.html#prettyFae" class="link">Source</a> <a href="#v:prettyFae" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Signers:Rep:4" class="instance expander" onclick="toggleSection('i:id:Signers:Rep:4')"></span> <span class="keyword">type</span> <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a></span> <a href="src/Blockchain.Fae.Internal.Storage.html#line-1" class="link">Source</a> <a href="#t:Signers" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Signers:Rep:4" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> = <a href="../base-4.10.0.0/GHC-Generics.html#t:D1">D1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaData">MetaData</a> &quot;Signers&quot; &quot;Blockchain.Fae.Internal.Storage&quot; &quot;fae-1.0.1.0-5yLYF7GcwlSFBKYFLyDks6&quot; <a href="../base-4.10.0.0/Data-Bool.html#v:True">True</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t:C1">C1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaCons">MetaCons</a> &quot;Signers&quot; <a href="../base-4.10.0.0/GHC-Generics.html#v:PrefixI">PrefixI</a> <a href="../base-4.10.0.0/Data-Bool.html#v:True">True</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t:S1">S1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaSel">MetaSel</a> (<a href="../base-4.10.0.0/Data-Maybe.html#v:Just">Just</a> <a href="../base-4.10.0.0/GHC-TypeLits.html#t:Symbol">Symbol</a> &quot;getSigners&quot;) <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceUnpackedness">NoSourceUnpackedness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceStrictness">NoSourceStrictness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:DecidedLazy">DecidedLazy</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t:Rec0">Rec0</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="../base-4.10.0.0/Data-String.html#t:String">String</a> <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a>))))</div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FaeStorageT" class="def">FaeStorageT</a> m c = <a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:StateT">StateT</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) m <a href="src/Blockchain.Fae.Internal.Storage.html#FaeStorageT" class="link">Source</a> <a href="#t:FaeStorageT" class="selflink">#</a></p><div class="doc"><p>The storage monad is just a state monad.  It's a transformer so that
 we can apply it to <code>Interpreter</code>; logically they are different.</p></div></div><h1 id="g:2">Template Haskell</h1><div class="top"><p class="src"><a id="v:_getSigners" class="def">_getSigners</a> :: <a href="../lens-4.15.4/Control-Lens-Type.html#t:Iso-39-">Iso'</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> (<a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="../base-4.10.0.0/Data-String.html#t:String">String</a> <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a>) <a href="src/Blockchain.Fae.Internal.Storage.html#line-109" class="link">Source</a> <a href="#v:_getSigners" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_getStorage" class="def">_getStorage</a> :: <span class="keyword">forall</span> c c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Iso">Iso</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) (<a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c)) (<a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c)) <a href="src/Blockchain.Fae.Internal.Storage.html#line-110" class="link">Source</a> <a href="#v:_getStorage" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_getInputOutputs" class="def">_getInputOutputs</a> :: <span class="keyword">forall</span> c c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Iso">Iso</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputsT">InputOutputsT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputsT">InputOutputsT</a> c) (<a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ShortContractID">ShortContractID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c)) (<a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ShortContractID">ShortContractID</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c)) <a href="src/Blockchain.Fae.Internal.Storage.html#line-111" class="link">Source</a> <a href="#v:_getInputOutputs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_signers" class="def">_signers</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c) <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> <a href="src/Blockchain.Fae.Internal.Storage.html#line-112" class="link">Source</a> <a href="#v:_signers" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_result" class="def">_result</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c) <a href="Blockchain-Fae-Internal-Storage.html#t:Result">Result</a> <a href="src/Blockchain.Fae.Internal.Storage.html#line-112" class="link">Source</a> <a href="#v:_result" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_outputs" class="def">_outputs</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c) <a href="src/Blockchain.Fae.Internal.Storage.html#line-112" class="link">Source</a> <a href="#v:_outputs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_inputOutputs" class="def">_inputOutputs</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputsT">InputOutputsT</a> c) <a href="src/Blockchain.Fae.Internal.Storage.html#line-112" class="link">Source</a> <a href="#v:_inputOutputs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_inputOrder" class="def">_inputOrder</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> c) [<a href="Blockchain-Fae-Internal-IDs-Types.html#t:ShortContractID">ShortContractID</a>] <a href="src/Blockchain.Fae.Internal.Storage.html#line-112" class="link">Source</a> <a href="#v:_inputOrder" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_iVersions" class="def">_iVersions</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) <a href="Blockchain-Fae-Internal-Versions.html#t:VersionRepMap">VersionRepMap</a> <a href="src/Blockchain.Fae.Internal.Storage.html#line-113" class="link">Source</a> <a href="#v:_iVersions" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_iRealID" class="def">_iRealID</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ContractID">ContractID</a> <a href="src/Blockchain.Fae.Internal.Storage.html#line-113" class="link">Source</a> <a href="#v:_iRealID" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_iOutputs" class="def">_iOutputs</a> :: <span class="keyword">forall</span> c c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens">Lens</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c) <a href="src/Blockchain.Fae.Internal.Storage.html#line-113" class="link">Source</a> <a href="#v:_iOutputs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_outputMap" class="def">_outputMap</a> :: <span class="keyword">forall</span> c c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens">Lens</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c) (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c) (<a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (c, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>)) (<a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (c, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>)) <a href="src/Blockchain.Fae.Internal.Storage.html#line-114" class="link">Source</a> <a href="#v:_outputMap" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_outputCount" class="def">_outputCount</a> :: <span class="keyword">forall</span> c. <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c) <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a> <a href="src/Blockchain.Fae.Internal.Storage.html#line-114" class="link">Source</a> <a href="#v:_outputCount" class="selflink">#</a></p></div><h1 id="g:3">Functions</h1><div class="top"><p class="src"><a id="v:hoistFaeStorage" class="def">hoistFaeStorage</a> :: <a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:FaeStorageT">FaeStorageT</a> <a href="Blockchain-Fae.html#t:Identity">Identity</a> c a -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:FaeStorageT">FaeStorageT</a> m c a <a href="src/Blockchain.Fae.Internal.Storage.html#hoistFaeStorage" class="link">Source</a> <a href="#v:hoistFaeStorage" class="selflink">#</a></p><div class="doc"><p>Raises the base monad</p></div></div><div class="top"><p class="src"><a id="v:nonceAt" class="def">nonceAt</a> :: <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ContractID">ContractID</a> -&gt; <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> c) (<a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (c, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>)) <a href="src/Blockchain.Fae.Internal.Storage.html#nonceAt" class="link">Source</a> <a href="#v:nonceAt" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="../lens-4.15.4/Control-Lens-At.html#v:at">at</a></code>, but retaining the nonce</p></div></div><div class="top"><p class="src"><a id="v:checkNonce" class="def">checkNonce</a> :: <a href="Blockchain-Fae-Internal-IDs-Types.html#t:ContractID">ContractID</a> -&gt; <a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> (<a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (a, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>)) (<a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> a) <a href="src/Blockchain.Fae.Internal.Storage.html#checkNonce" class="link">Source</a> <a href="#v:checkNonce" class="selflink">#</a></p><div class="doc"><p>Enforces nonce-correctness when it is required</p></div></div><div class="top"><p class="src"><a id="v:nonceSetter" class="def">nonceSetter</a> :: <a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (a, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>) -&gt; <a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> a -&gt; <a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (a, <a href="../base-4.10.0.0/Data-Int.html#t:Int">Int</a>) <a href="src/Blockchain.Fae.Internal.Storage.html#nonceSetter" class="link">Source</a> <a href="#v:nonceSetter" class="selflink">#</a></p><div class="doc"><p>Updating a contract entry nonce-correctly</p></div></div><div class="top"><p class="src"><a id="v:listToOutputs" class="def">listToOutputs</a> :: [c] -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c <a href="src/Blockchain.Fae.Internal.Storage.html#listToOutputs" class="link">Source</a> <a href="#v:listToOutputs" class="selflink">#</a></p><div class="doc"><p>Just an <code><a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a></code> constructor, indexing consecutively from 0.</p></div></div><div class="top"><p class="src"><a id="v:emptyOutputs" class="def">emptyOutputs</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c <a href="src/Blockchain.Fae.Internal.Storage.html#emptyOutputs" class="link">Source</a> <a href="#v:emptyOutputs" class="selflink">#</a></p><div class="doc"><p>Like the name says.</p></div></div><div class="top"><p class="src"><a id="v:combineIOV" class="def">combineIOV</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputVersionsT">InputOutputVersionsT</a> c <a href="src/Blockchain.Fae.Internal.Storage.html#combineIOV" class="link">Source</a> <a href="#v:combineIOV" class="selflink">#</a></p><div class="doc"><p>Unions the outputs and the versions of the two arguments.  The failure
 mode is when the arguments have a different <code><a href="Blockchain-Fae-Internal-Storage.html#v:iRealID">iRealID</a></code>, in which case we
 choose the second one for the result.  This is because in <a href="Transaction.html">Transaction</a>,
 the second argument is the old entry, and we want to prevent people from
 screwing up contract calls by way of subsequent calls.  This is
 extraordinarily unlikely anyway, the way that the module works currently,
 since to do so would require manufacturing a hash collision for the
 short IDs.  If that happens, the later contract call is <em>definitely</em>
 malicious, and so it's okay to mishandle it.</p></div></div><div class="top"><p class="src"><a id="v:combineO" class="def">combineO</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> c <a href="src/Blockchain.Fae.Internal.Storage.html#combineO" class="link">Source</a> <a href="#v:combineO" class="selflink">#</a></p><div class="doc"><p>Concatenates two output lists, shifting the second one by the full
 count of the first one.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.18.1</p></div></body></html>