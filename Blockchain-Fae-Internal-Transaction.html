<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Blockchain.Fae.Internal.Transaction</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Blockchain-Fae-Internal-Transaction.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Blockchain.Fae.Internal.Transaction.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">fae-0.9.0.0</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Ryan Reich 2017</td></tr><tr><th>License</th><td>MIT</td></tr><tr><th>Maintainer</th><td>ryan.reich@gmail.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Blockchain.Fae.Internal.Transaction</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Types</a></li><li><a href="#g:2">Functions</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module provides the code that navigates the intricacies of executing a transaction.  It is useful for front-end implementations, but not to users.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:Storage">Storage</a> = <a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Outputs">Outputs</a> = <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:InputOutputs">InputOutputs</a> = <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputsT">InputOutputsT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:FaeStorage">FaeStorage</a> = <a href="Blockchain-Fae-Internal-Storage.html#t:FaeStorageT">FaeStorageT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:TransactionEntry">TransactionEntry</a> = <a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Inputs">Inputs</a> = [(<a href="Blockchain-Fae-Internal-IDs.html#t:ContractID">ContractID</a>, <a href="../base-4.9.1.0/Data-String.html#t:String">String</a>)]</li><li class="src short"><span class="keyword">type</span> <a href="#t:Transaction">Transaction</a> a b = a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeTX">FaeTX</a> b</li><li class="src short"><span class="keyword">data</span> <a href="#t:TransactionException">TransactionException</a><ul class="subs"><li>= <a href="#v:NotEnoughInputs">NotEnoughInputs</a></li><li>| <a href="#v:TooManyInputs">TooManyInputs</a></li><li>| <a href="#v:BadInput">BadInput</a> <a href="Blockchain-Fae-Internal-IDs.html#t:ContractID">ContractID</a></li><li>| <a href="#v:OpenEscrows">OpenEscrows</a></li></ul></li><li class="src short"><span class="keyword">class</span> <a href="#t:GetInputValues">GetInputValues</a> a <span class="keyword">where</span><ul class="subs"></ul></li><li class="src short"><span class="keyword">class</span> <a href="#t:GGetInputValues">GGetInputValues</a> f <span class="keyword">where</span><ul class="subs"></ul></li><li class="src short"><a href="#v:runTransaction">runTransaction</a> :: (<a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> inputs, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> inputs, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> a, <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> a) =&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Transaction">Transaction</a> inputs a -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Inputs">Inputs</a> -&gt; <a href="Blockchain-Fae-Internal-IDs.html#t:TransactionID">TransactionID</a> -&gt; <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:FaeStorage">FaeStorage</a> ()</li><li class="src short"><a href="#v:runFaeContract">runFaeContract</a> :: <a href="Blockchain-Fae-Internal-IDs.html#t:TransactionID">TransactionID</a> -&gt; <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> a -&gt; a</li><li class="src short"><a href="#v:transaction">transaction</a> :: (<a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> input, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> input, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> a, <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> a) =&gt; <a href="Blockchain-Fae-Internal-IDs.html#t:TransactionID">TransactionID</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Inputs">Inputs</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Transaction">Transaction</a> input a -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a></li><li class="src short"><a href="#v:doTX">doTX</a> :: <a href="Blockchain-Fae-Internal-Transaction.html#t:Transaction">Transaction</a> input a -&gt; input -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> (a, <a href="Blockchain-Fae-Internal-Transaction.html#t:Outputs">Outputs</a>)</li><li class="src short"><a href="#v:runInputSpec">runInputSpec</a> :: <span class="keyword">forall</span> input. (<a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> input, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> input) =&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Inputs">Inputs</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> (input, <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a>, <a href="Blockchain-Fae-Internal-Transaction.html#t:InputOutputs">InputOutputs</a>)</li><li class="src short"><a href="#v:runInputContracts">runInputContracts</a> :: (<a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> input, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> input) =&gt; <a href="../base-4.9.1.0/Data-Proxy.html#t:Proxy">Proxy</a> input -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Inputs">Inputs</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> ([<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>], <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a>, <a href="Blockchain-Fae-Internal-Transaction.html#t:InputOutputs">InputOutputs</a>)</li><li class="src short"><a href="#v:runInputContract">runInputContract</a> :: <span class="keyword">forall</span> input. (<a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> input, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> input) =&gt; <a href="../base-4.9.1.0/Data-Proxy.html#t:Proxy">Proxy</a> input -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Blockchain-Fae-Internal-IDs.html#t:ContractID">ContractID</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; ([<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>], <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a>, <a href="Blockchain-Fae-Internal-Transaction.html#t:InputOutputs">InputOutputs</a>) -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> ([<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>], <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a>, <a href="Blockchain-Fae-Internal-Transaction.html#t:InputOutputs">InputOutputs</a>)</li></ul></div><div id="interface"><h1 id="g:1">Types</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Storage" class="def">Storage</a> = <a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a> <a href="src/Blockchain.Fae.Internal.Transaction.html#Storage" class="link">Source</a> <a href="#t:Storage" class="selflink">#</a></p><div class="doc"><p><code><a href="Blockchain-Fae-Internal-Storage.html#t:StorageT">StorageT</a></code> is only parametrized because <code><a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a></code> isn't
 defined in <a href="Storage.html">Storage</a>, which is because it would cause an import cycle.
 Storage always contains abstract contracts.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Outputs" class="def">Outputs</a> = <a href="Blockchain-Fae-Internal-Storage.html#t:OutputsT">OutputsT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a> <a href="src/Blockchain.Fae.Internal.Transaction.html#Outputs" class="link">Source</a> <a href="#t:Outputs" class="selflink">#</a></p><div class="doc"><p>Likewise</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:InputOutputs" class="def">InputOutputs</a> = <a href="Blockchain-Fae-Internal-Storage.html#t:InputOutputsT">InputOutputsT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a> <a href="src/Blockchain.Fae.Internal.Transaction.html#InputOutputs" class="link">Source</a> <a href="#t:InputOutputs" class="selflink">#</a></p><div class="doc"><p>Likewise</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FaeStorage" class="def">FaeStorage</a> = <a href="Blockchain-Fae-Internal-Storage.html#t:FaeStorageT">FaeStorageT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a> <a href="src/Blockchain.Fae.Internal.Transaction.html#FaeStorage" class="link">Source</a> <a href="#t:FaeStorage" class="selflink">#</a></p><div class="doc"><p>Likewise</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TransactionEntry" class="def">TransactionEntry</a> = <a href="Blockchain-Fae-Internal-Storage.html#t:TransactionEntryT">TransactionEntryT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a> <a href="src/Blockchain.Fae.Internal.Transaction.html#TransactionEntry" class="link">Source</a> <a href="#t:TransactionEntry" class="selflink">#</a></p><div class="doc"><p>Likewise</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Inputs" class="def">Inputs</a> = [(<a href="Blockchain-Fae-Internal-IDs.html#t:ContractID">ContractID</a>, <a href="../base-4.9.1.0/Data-String.html#t:String">String</a>)] <a href="src/Blockchain.Fae.Internal.Transaction.html#Inputs" class="link">Source</a> <a href="#t:Inputs" class="selflink">#</a></p><div class="doc"><p>How inputs are provided to transactions.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Transaction" class="def">Transaction</a> a b = a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeTX">FaeTX</a> b <a href="src/Blockchain.Fae.Internal.Transaction.html#Transaction" class="link">Source</a> <a href="#t:Transaction" class="selflink">#</a></p><div class="doc"><p>Transactions, though similar to contracts in many internal ways,
 differ greatly in their inputs and outputs.  The argument of type <code>a</code> is
 constructed from the return values of the input contracts according to
 its <code><a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a></code> instance.  The return value need not and can not
 contain escrows (or rather, the escrow IDs it contains will not be
 transferred anywhere).</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TransactionException" class="def">TransactionException</a> <a href="src/Blockchain.Fae.Internal.Transaction.html#TransactionException" class="link">Source</a> <a href="#t:TransactionException" class="selflink">#</a></p><div class="doc"><p>Exception type</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NotEnoughInputs" class="def">NotEnoughInputs</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TooManyInputs" class="def">TooManyInputs</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:BadInput" class="def">BadInput</a> <a href="Blockchain-Fae-Internal-IDs.html#t:ContractID">ContractID</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:OpenEscrows" class="def">OpenEscrows</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:TransactionException" class="caption collapser" onclick="toggleSection('i:TransactionException')">Instances</p><div id="section.i:TransactionException" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:TransactionException:Show:1" class="instance expander" onclick="toggleSection('i:id:TransactionException:Show:1')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Blockchain-Fae-Internal-Transaction.html#t:TransactionException">TransactionException</a></span> <a href="src/Blockchain.Fae.Internal.Transaction.html#line-74" class="link">Source</a> <a href="#t:TransactionException" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:TransactionException:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:TransactionException">TransactionException</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Blockchain-Fae-Internal-Transaction.html#t:TransactionException">TransactionException</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Blockchain-Fae-Internal-Transaction.html#t:TransactionException">TransactionException</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:TransactionException:Exception:2" class="instance expander" onclick="toggleSection('i:id:TransactionException:Exception:2')"></span> <a href="../base-4.9.1.0/Control-Exception-Base.html#t:Exception">Exception</a> <a href="Blockchain-Fae-Internal-Transaction.html#t:TransactionException">TransactionException</a></span> <a href="src/Blockchain.Fae.Internal.Transaction.html#line-103" class="link">Source</a> <a href="#t:TransactionException" class="selflink">#</a></td><td class="doc"><p>Of course</p></td></tr><tr><td colspan="2"><div id="section.i:id:TransactionException:Exception:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toException">toException</a> :: <a href="Blockchain-Fae-Internal-Transaction.html#t:TransactionException">TransactionException</a> -&gt; <a href="../base-4.9.1.0/Control-Exception-Base.html#t:SomeException">SomeException</a> <a href="#v:toException" class="selflink">#</a></p><p class="src"><a href="#v:fromException">fromException</a> :: <a href="../base-4.9.1.0/Control-Exception-Base.html#t:SomeException">SomeException</a> -&gt; <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Blockchain-Fae-Internal-Transaction.html#t:TransactionException">TransactionException</a> <a href="#v:fromException" class="selflink">#</a></p><p class="src"><a href="#v:displayException">displayException</a> :: <a href="Blockchain-Fae-Internal-Transaction.html#t:TransactionException">TransactionException</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:displayException" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:GetInputValues" class="def">GetInputValues</a> a <span class="keyword">where</span> <a href="src/Blockchain.Fae.Internal.Transaction.html#GetInputValues" class="link">Source</a> <a href="#t:GetInputValues" class="selflink">#</a></p><div class="doc"><p>This class controls how a type is constructed from
 a heterogeneously-typed list of input return values.  Its default
 instance, for any <code><a href="Blockchain-Fae.html#t:Generic">Generic</a></code> type, simply assigns each field of a product
 type from successive values in the list, failing if they don't all match
 or there are extras on one side.  For the moment, the member function is
 not exported, so you can't write your own implementations; however, you
 do need to <code>instance GetInputValues <a href="your">type</a></code> for any <code>a</code> you choose
 to use.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:getInputValues" class="def">getInputValues</a> :: [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>] -&gt; (a, [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>]) <a href="src/Blockchain.Fae.Internal.Transaction.html#getInputValues" class="link">Source</a> <a href="#v:getInputValues" class="selflink">#</a></p><p class="src"><a id="v:getInputValues" class="def">getInputValues</a> :: (<a href="Blockchain-Fae.html#t:Generic">Generic</a> a, <a href="Blockchain-Fae-Internal-Transaction.html#t:GGetInputValues">GGetInputValues</a> (<a href="../base-4.9.1.0/GHC-Generics.html#t:Rep">Rep</a> a)) =&gt; [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>] -&gt; (a, [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>]) <a href="src/Blockchain.Fae.Internal.Transaction.html#getInputValues" class="link">Source</a> <a href="#v:getInputValues" class="selflink">#</a></p></div><div class="subs instances"><p id="control.i:GetInputValues" class="caption collapser" onclick="toggleSection('i:GetInputValues')">Instances</p><div id="section.i:GetInputValues" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:GetInputValues:GetInputValues:1" class="instance expander" onclick="toggleSection('i:ic:GetInputValues:GetInputValues:1')"></span> <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> a =&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> a</span> <a href="src/Blockchain.Fae.Internal.Transaction.html#line-115" class="link">Source</a> <a href="#t:GetInputValues" class="selflink">#</a></td><td class="doc"><p>By default, any type tries to take a single input as its entire value.
 This may not actually be the case, of course.</p></td></tr><tr><td colspan="2"><div id="section.i:ic:GetInputValues:GetInputValues:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:getInputValues">getInputValues</a> :: [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>] -&gt; (a, [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>]) <a href="src/Blockchain.Fae.Internal.Transaction.html#getInputValues" class="link">Source</a> <a href="#v:getInputValues" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:GetInputValues:GetInputValues:2" class="instance expander" onclick="toggleSection('i:ic:GetInputValues:GetInputValues:2')"></span> <a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> <a href="Blockchain-Fae.html#t:Void">Void</a></span> <a href="src/Blockchain.Fae.Internal.Transaction.html#line-107" class="link">Source</a> <a href="#t:GetInputValues" class="selflink">#</a></td><td class="doc"><p>Empty types not only have no input values, it is insulting to suggest
 that they might.</p></td></tr><tr><td colspan="2"><div id="section.i:ic:GetInputValues:GetInputValues:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:getInputValues">getInputValues</a> :: [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>] -&gt; (<a href="Blockchain-Fae.html#t:Void">Void</a>, [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>]) <a href="src/Blockchain.Fae.Internal.Transaction.html#getInputValues" class="link">Source</a> <a href="#v:getInputValues" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:GetInputValues:GetInputValues:3" class="instance expander" onclick="toggleSection('i:ic:GetInputValues:GetInputValues:3')"></span> (<a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> a, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> b) =&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> (a, b)</span> <a href="src/Blockchain.Fae.Internal.Transaction.html#line-111" class="link">Source</a> <a href="#t:GetInputValues" class="selflink">#</a></td><td class="doc"><p>Default instance</p></td></tr><tr><td colspan="2"><div id="section.i:ic:GetInputValues:GetInputValues:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:getInputValues">getInputValues</a> :: [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>] -&gt; ((a, b), [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>]) <a href="src/Blockchain.Fae.Internal.Transaction.html#getInputValues" class="link">Source</a> <a href="#v:getInputValues" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:GGetInputValues" class="def">GGetInputValues</a> f <span class="keyword">where</span> <a href="src/Blockchain.Fae.Internal.Transaction.html#GGetInputValues" class="link">Source</a> <a href="#t:GGetInputValues" class="selflink">#</a></p><div class="doc"><p>Generic helper class</p></div><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src"><a href="Blockchain-Fae-Internal-Transaction.html#v:gGetInputValues">gGetInputValues</a></p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:gGetInputValues" class="def">gGetInputValues</a> :: <a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:State">State</a> [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>] (f p) <a href="src/Blockchain.Fae.Internal.Transaction.html#gGetInputValues" class="link">Source</a> <a href="#v:gGetInputValues" class="selflink">#</a></p><div class="doc"><p>This is in the <code><a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:State">State</a></code> monad, rather than having the same signature as
 <code><a href="Blockchain-Fae-Internal-Transaction.html#v:getInputValues">getInputValues</a></code>, because we need to walk through the list of dynamic
 inputs and progressively remove values from it.  At the same time, we
 need to know if there were leftovers.</p></div></div><div class="subs instances"><p id="control.i:GGetInputValues" class="caption collapser" onclick="toggleSection('i:GGetInputValues')">Instances</p><div id="section.i:GGetInputValues" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:GGetInputValues:GGetInputValues:1" class="instance expander" onclick="toggleSection('i:ic:GGetInputValues:GGetInputValues:1')"></span> <a href="Blockchain-Fae-Internal-Transaction.html#t:GGetInputValues">GGetInputValues</a> <a href="../base-4.9.1.0/GHC-Generics.html#t:U1">U1</a></span> <a href="src/Blockchain.Fae.Internal.Transaction.html#line-122" class="link">Source</a> <a href="#t:GGetInputValues" class="selflink">#</a></td><td class="doc"><p>No values in a constructor with no records</p></td></tr><tr><td colspan="2"><div id="section.i:ic:GGetInputValues:GGetInputValues:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:gGetInputValues">gGetInputValues</a> :: <a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:State">State</a> [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>] (<a href="../base-4.9.1.0/GHC-Generics.html#t:U1">U1</a> p) <a href="src/Blockchain.Fae.Internal.Transaction.html#gGetInputValues" class="link">Source</a> <a href="#v:gGetInputValues" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:GGetInputValues:GGetInputValues:2" class="instance expander" onclick="toggleSection('i:ic:GGetInputValues:GGetInputValues:2')"></span> <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> c =&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:GGetInputValues">GGetInputValues</a> (<a href="../base-4.9.1.0/GHC-Generics.html#t:K1">K1</a> i c)</span> <a href="src/Blockchain.Fae.Internal.Transaction.html#line-137" class="link">Source</a> <a href="#t:GGetInputValues" class="selflink">#</a></td><td class="doc"><p>For a nested type, we peel off one input and fix its type.  We do
 <em>not</em> do a recursive call.</p></td></tr><tr><td colspan="2"><div id="section.i:ic:GGetInputValues:GGetInputValues:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:gGetInputValues">gGetInputValues</a> :: <a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:State">State</a> [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>] (<a href="../base-4.9.1.0/GHC-Generics.html#t:K1">K1</a> i c p) <a href="src/Blockchain.Fae.Internal.Transaction.html#gGetInputValues" class="link">Source</a> <a href="#v:gGetInputValues" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:GGetInputValues:GGetInputValues:3" class="instance expander" onclick="toggleSection('i:ic:GGetInputValues:GGetInputValues:3')"></span> (<a href="Blockchain-Fae-Internal-Transaction.html#t:GGetInputValues">GGetInputValues</a> f, <a href="Blockchain-Fae-Internal-Transaction.html#t:GGetInputValues">GGetInputValues</a> g) =&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:GGetInputValues">GGetInputValues</a> (<a href="../base-4.9.1.0/GHC-Generics.html#t::-42-:">(:*:)</a> f g)</span> <a href="src/Blockchain.Fae.Internal.Transaction.html#line-129" class="link">Source</a> <a href="#t:GGetInputValues" class="selflink">#</a></td><td class="doc"><p>We only allow product types to have input values, because how would
 one choose between different branches of a sum type?  Non-algebraic
 types are out of luck because we don't expose the methods of
 <code><a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a></code> to be implemented manually.</p></td></tr><tr><td colspan="2"><div id="section.i:ic:GGetInputValues:GGetInputValues:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:gGetInputValues">gGetInputValues</a> :: <a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:State">State</a> [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>] ((f <a href="../base-4.9.1.0/GHC-Generics.html#t::-42-:">:*:</a> g) p) <a href="src/Blockchain.Fae.Internal.Transaction.html#gGetInputValues" class="link">Source</a> <a href="#v:gGetInputValues" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:GGetInputValues:GGetInputValues:4" class="instance expander" onclick="toggleSection('i:ic:GGetInputValues:GGetInputValues:4')"></span> <a href="Blockchain-Fae-Internal-Transaction.html#t:GGetInputValues">GGetInputValues</a> f =&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:GGetInputValues">GGetInputValues</a> (<a href="../base-4.9.1.0/GHC-Generics.html#t:M1">M1</a> i t f)</span> <a href="src/Blockchain.Fae.Internal.Transaction.html#line-148" class="link">Source</a> <a href="#t:GGetInputValues" class="selflink">#</a></td><td class="doc"><p>Just ignore metadata for this one.</p></td></tr><tr><td colspan="2"><div id="section.i:ic:GGetInputValues:GGetInputValues:4" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:gGetInputValues">gGetInputValues</a> :: <a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:State">State</a> [<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>] (<a href="../base-4.9.1.0/GHC-Generics.html#t:M1">M1</a> i t f p) <a href="src/Blockchain.Fae.Internal.Transaction.html#gGetInputValues" class="link">Source</a> <a href="#v:gGetInputValues" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><h1 id="g:2">Functions</h1><div class="top"><p class="src"><a id="v:runTransaction" class="def">runTransaction</a> :: (<a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> inputs, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> inputs, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> a, <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> a) =&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Transaction">Transaction</a> inputs a -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Inputs">Inputs</a> -&gt; <a href="Blockchain-Fae-Internal-IDs.html#t:TransactionID">TransactionID</a> -&gt; <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:FaeStorage">FaeStorage</a> () <a href="src/Blockchain.Fae.Internal.Transaction.html#runTransaction" class="link">Source</a> <a href="#v:runTransaction" class="selflink">#</a></p><div class="doc"><p>Runs a transaction on its inputs, with some basic information about
 the context.  This is written as a <code><a href="../mtl-2.2.1/Control-Monad-State-Class.html#v:modify">modify</a></code> call, so that the actual
 transaction running can be pure functions.</p></div></div><div class="top"><p class="src"><a id="v:runFaeContract" class="def">runFaeContract</a> :: <a href="Blockchain-Fae-Internal-IDs.html#t:TransactionID">TransactionID</a> -&gt; <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> a -&gt; a <a href="src/Blockchain.Fae.Internal.Transaction.html#runFaeContract" class="link">Source</a> <a href="#v:runFaeContract" class="selflink">#</a></p><div class="doc"><p>A summary monad-running function.  You start with no escrows and the
 next escrow ID is the transaction ID.</p></div></div><div class="top"><p class="src"><a id="v:transaction" class="def">transaction</a> :: (<a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> input, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> input, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> a, <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> a) =&gt; <a href="Blockchain-Fae-Internal-IDs.html#t:TransactionID">TransactionID</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Inputs">Inputs</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Transaction">Transaction</a> input a -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a> <a href="src/Blockchain.Fae.Internal.Transaction.html#transaction" class="link">Source</a> <a href="#v:transaction" class="selflink">#</a></p><div class="doc"><p>Running the actual <code><a href="Blockchain-Fae-Internal-Transaction.html#t:Transaction">Transaction</a></code> as a function.  We don't convert to
 <code><a href="Blockchain-Fae-Internal-Contract.html#t:InternalT">InternalT</a></code> or <code><a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a></code> because transactions are rather
 unique: the handling of the arguments and the escrows is quite
 different.</p></div></div><div class="top"><p class="src"><a id="v:doTX" class="def">doTX</a> :: <a href="Blockchain-Fae-Internal-Transaction.html#t:Transaction">Transaction</a> input a -&gt; input -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> (a, <a href="Blockchain-Fae-Internal-Transaction.html#t:Outputs">Outputs</a>) <a href="src/Blockchain.Fae.Internal.Transaction.html#doTX" class="link">Source</a> <a href="#v:doTX" class="selflink">#</a></p><div class="doc"><p>Runs the transaction and checks that it didn't leave any escrows open.
 That would allow value to be destroyed, possibly by accident, which is
 bad.</p></div></div><div class="top"><p class="src"><a id="v:runInputSpec" class="def">runInputSpec</a> :: <span class="keyword">forall</span> input. (<a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> input, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> input) =&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Inputs">Inputs</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> (input, <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a>, <a href="Blockchain-Fae-Internal-Transaction.html#t:InputOutputs">InputOutputs</a>) <a href="src/Blockchain.Fae.Internal.Transaction.html#runInputSpec" class="link">Source</a> <a href="#v:runInputSpec" class="selflink">#</a></p><div class="doc"><p>Takes the list of contract IDs with input strings and forms the input
 object out of their results, taking care to resolve its escrow locators.</p></div></div><div class="top"><p class="src"><a id="v:runInputContracts" class="def">runInputContracts</a> :: (<a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> input, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> input) =&gt; <a href="../base-4.9.1.0/Data-Proxy.html#t:Proxy">Proxy</a> input -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a> -&gt; <a href="Blockchain-Fae-Internal-Transaction.html#t:Inputs">Inputs</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> ([<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>], <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a>, <a href="Blockchain-Fae-Internal-Transaction.html#t:InputOutputs">InputOutputs</a>) <a href="src/Blockchain.Fae.Internal.Transaction.html#runInputContracts" class="link">Source</a> <a href="#v:runInputContracts" class="selflink">#</a></p><div class="doc"><p>Runs all the input contracts in a state monad recording the
 progressively increasing set of outputs.</p></div></div><div class="top"><p class="src"><a id="v:runInputContract" class="def">runInputContract</a> :: <span class="keyword">forall</span> input. (<a href="Blockchain-Fae-Internal-Transaction.html#t:GetInputValues">GetInputValues</a> input, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> input) =&gt; <a href="../base-4.9.1.0/Data-Proxy.html#t:Proxy">Proxy</a> input -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Blockchain-Fae-Internal-IDs.html#t:ContractID">ContractID</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; ([<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>], <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a>, <a href="Blockchain-Fae-Internal-Transaction.html#t:InputOutputs">InputOutputs</a>) -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> ([<a href="../base-4.9.1.0/Data-Dynamic.html#t:Dynamic">Dynamic</a>], <a href="Blockchain-Fae-Internal-Transaction.html#t:Storage">Storage</a>, <a href="Blockchain-Fae-Internal-Transaction.html#t:InputOutputs">InputOutputs</a>) <a href="src/Blockchain.Fae.Internal.Transaction.html#runInputContract" class="link">Source</a> <a href="#v:runInputContract" class="selflink">#</a></p><div class="doc"><p>Runs a single input contract.  It is here that the rewards are
 created, if any.  This function uses the list of previous results to
 partially construct an input object for looking up escrow locators in
 the present contract; this only works because of laziness.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>