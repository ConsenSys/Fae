<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Blockchain.Fae.Internal.Contract</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Blockchain.Fae.Internal.Contract.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">fae-0.9.9.9</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Ryan Reich 2017-2018</td></tr><tr><th>License</th><td>MIT</td></tr><tr><th>Maintainer</th><td>ryan.reich@gmail.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Blockchain.Fae.Internal.Contract</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Types</a></li><li><a href="#g:2">Template Haskell</a></li><li><a href="#g:3">Functions</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Everything in Fae is a contract, and this module defines contracts and
their construction.</p><p>It may be a little confusing how a user-provided <code>Contract</code> becomes the
<code><a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a></code> stored by Fae.  This happens in three steps:</p><ul><li>A <code>Contract</code> is partially &quot;compiled&quot; to an <code><a href="Blockchain-Fae-Internal-Contract.html#t:InternalContract">InternalContract</a></code>, which
  handles escrows in the first call and also makes the entire escrow
  storage private.</li><li>An <code><a href="Blockchain-Fae-Internal-Contract.html#t:InternalContract">InternalContract</a></code> is further &quot;compiled&quot; to a <code><a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a></code>,
  which handles the suspend/resume mechanism and makes a contract basically
  isomorphic to a function from argument to value types.</li><li>A <code><a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a></code> is, finally, made into an <code><a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a></code>,
  which handles conversion of its input and output types from and to
  untyped <code><a href="../base-4.10.0.0/Data-String.html#t:String">String</a></code> and 'BearsValue, respectively.  It also resolves version
  IDs to their corresponding correctly-typed values.</li></ul><p>Each of these stages takes place in some <code>FaeContract s</code> monad, but it is
important to understand that in fact, there are <em>three</em> different monad
contexts occurring in the life cycle of a contract:</p><ul><li>The one inside the contract, in which the user-defined code is executed;</li><li>The one in which the contract is created;</li><li>The one in which the contract is called.</li></ul><p>Information is passed among all of these in a manner controlled by the
three steps shown above.  Escrows from the creating context are passed in
via <code><a href="Blockchain-Fae-Internal-IDs.html#v:bearer">bearer</a></code> to the internal context; escrows from the return value (and
for escrows themselves, also the argument) are passed via <code><a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a></code>;
and the <code><a href="Blockchain-Fae-Internal-Contract.html#t:FaeRWT">FaeRWT</a></code> stratum is shared between the internal context and the
calling context.  The effect of the <code><a href="Blockchain-Fae-Internal-Contract.html#t:InternalContract">InternalContract</a></code> stage is to prevent
escrows from being shared between the internal and calling contexts except
as mediated by <code><a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a></code>.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:Escrows">Escrows</a> = <a href="#v:Escrows">Escrows</a> {<ul class="subs"><li><a href="#v:escrowMap">escrowMap</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:EscrowMap">EscrowMap</a></li><li><a href="#v:nextID">nextID</a> :: <a href="Blockchain-Fae-Internal-IDs-Types.html#t:EntryID">EntryID</a></li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:EscrowMap">EscrowMap</a> = <a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:EntryID">EntryID</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:AbstractEscrow">AbstractEscrow</a>, <a href="Blockchain-Fae-Internal-IDs-Types.html#t:VersionID">VersionID</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:WithEscrows">WithEscrows</a> a = <a href="#v:WithEscrows">WithEscrows</a> <a href="Blockchain-Fae-Internal-Contract.html#t:EscrowMap">EscrowMap</a> a</li><li class="src short"><span class="keyword">type</span> <a href="#t:FaeRequest">FaeRequest</a> argType valType = <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine-SuspensionFunctors.html#t:Request">Request</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> valType) (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> argType)</li><li class="src short"><span class="keyword">type</span> <a href="#t:FaeRWT">FaeRWT</a> m = <a href="../mtl-2.2.1/Control-Monad-Writer-Lazy.html#t:WriterT">WriterT</a> [<a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a>] (<a href="../mtl-2.2.1/Control-Monad-Reader.html#t:ReaderT">ReaderT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:TXData">TXData</a> m)</li><li class="src short"><span class="keyword">type</span> <a href="#t:FaeRW">FaeRW</a> = <a href="Blockchain-Fae-Internal-Contract.html#t:FaeRWT">FaeRWT</a> <a href="Blockchain-Fae.html#t:Identity">Identity</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TXData">TXData</a> = <a href="#v:TXData">TXData</a> {<ul class="subs"><li><a href="#v:txSigners">txSigners</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a></li><li><a href="#v:thisTXID">thisTXID</a> :: <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a></li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:FaeContractT">FaeContractT</a> s m = <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Coroutine">Coroutine</a> s (<a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeRWT">FaeRWT</a> m))</li><li class="src short"><span class="keyword">type</span> <a href="#t:FaeContract">FaeContract</a> s = <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s <a href="Blockchain-Fae.html#t:Identity">Identity</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:ContractT">ContractT</a> m argType valType = argType -&gt; m (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> valType)</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:FaeM">FaeM</a> s a = <a href="#v:Fae">Fae</a> {<ul class="subs"><li><a href="#v:getFae">getFae</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s a</li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:InternalT">InternalT</a> s argType valType = <a href="Blockchain-Fae-Internal-Contract.html#t:ContractT">ContractT</a> (<a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Coroutine">Coroutine</a> s <a href="Blockchain-Fae-Internal-Contract.html#t:FaeRW">FaeRW</a>) argType valType</li><li class="src short"><span class="keyword">type</span> <a href="#t:InternalContract">InternalContract</a> argType valType = <a href="Blockchain-Fae-Internal-Contract.html#t:InternalT">InternalT</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeRequest">FaeRequest</a> argType valType) (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> argType) valType</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:ConcreteContract">ConcreteContract</a> argType valType = <a href="#v:ConcreteContract">ConcreteContract</a> (<span class="keyword">forall</span> s m. (<a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s, <a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m) =&gt; argType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s m (<a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> argType valType), valType))</li><li class="src short"><span class="keyword">type</span> <a href="#t:AbstractEscrow">AbstractEscrow</a> = <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> <a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a> <a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:AbstractContract">AbstractContract</a> = <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> (<a href="../base-4.10.0.0/Data-String.html#t:String">String</a>, <a href="Blockchain-Fae-Internal-Versions.html#t:VersionMap">VersionMap</a>) (<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>, <a href="Blockchain-Fae-Internal-Versions.html#t:VersionMap">VersionMap</a>)</li><li class="src short"><a href="#v:_nextID">_nextID</a> :: <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:EntryID">EntryID</a></li><li class="src short"><a href="#v:_escrowMap">_escrowMap</a> :: <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> <a href="Blockchain-Fae-Internal-Contract.html#t:EscrowMap">EscrowMap</a></li><li class="src short"><a href="#v:_txSigners">_txSigners</a> :: <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> <a href="Blockchain-Fae-Internal-Contract.html#t:TXData">TXData</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a></li><li class="src short"><a href="#v:_thisTXID">_thisTXID</a> :: <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> <a href="Blockchain-Fae-Internal-Contract.html#t:TXData">TXData</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a></li><li class="src short"><a href="#v:makeInternalT">makeInternalT</a> :: (<a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s, <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s', <a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m) =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ContractT">ContractT</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s') argType valType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s m (<a href="Blockchain-Fae-Internal-Contract.html#t:InternalT">InternalT</a> s' (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> argType) valType)</li><li class="src short"><a href="#v:makeConcrete">makeConcrete</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType) =&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:InternalContract">InternalContract</a> argType valType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> argType valType</li><li class="src short"><a href="#v:makeEscrowAbstract">makeEscrowAbstract</a> :: <span class="keyword">forall</span> argType valType. (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType) =&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> argType valType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractEscrow">AbstractEscrow</a></li><li class="src short"><a href="#v:makeContractAbstract">makeContractAbstract</a> :: <span class="keyword">forall</span> argType valType. (<a href="../base-4.10.0.0/Text-Read.html#t:Read">Read</a> argType, <a href="Blockchain-Fae-Internal-NFData.html#t:NFData">NFData</a> valType, <a href="Blockchain-Fae-Internal-Versions.html#t:Versionable">Versionable</a> argType, <a href="Blockchain-Fae-Internal-Versions.html#t:Versionable">Versionable</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType) =&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> argType valType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a></li><li class="src short"><a href="#v:unmakeAbstractEscrow">unmakeAbstractEscrow</a> :: <span class="keyword">forall</span> argType valType. (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType) =&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractEscrow">AbstractEscrow</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> argType valType</li><li class="src short"><a href="#v:takeEscrows">takeEscrows</a> :: <a href="../adjunctions-4.3/Control-Monad-Representable-State.html#t:MonadState">MonadState</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> m =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; m <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a></li><li class="src short"><a href="#v:getEscrowMap">getEscrowMap</a> :: <span class="keyword">forall</span> m. <a href="../adjunctions-4.3/Control-Monad-Representable-State.html#t:MonadState">MonadState</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> m =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; m <a href="Blockchain-Fae-Internal-Contract.html#t:EscrowMap">EscrowMap</a></li><li class="src short"><a href="#v:takeEscrow">takeEscrow</a> :: <a href="../adjunctions-4.3/Control-Monad-Representable-State.html#t:MonadState">MonadState</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> m =&gt; <a href="Blockchain-Fae-Internal-IDs-Types.html#t:EscrowID">EscrowID</a> argType valType -&gt; m (<a href="Blockchain-Fae-Internal-IDs-Types.html#t:EntryID">EntryID</a>, (<a href="Blockchain-Fae-Internal-Contract.html#t:AbstractEscrow">AbstractEscrow</a>, <a href="Blockchain-Fae-Internal-IDs-Types.html#t:VersionID">VersionID</a>))</li><li class="src short"><a href="#v:internalSpend">internalSpend</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType, <a href="../adjunctions-4.3/Control-Monad-Representable-State.html#t:MonadState">MonadState</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> m) =&gt; valType -&gt; m (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> valType)</li><li class="src short"><a href="#v:internalNewEscrow">internalNewEscrow</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType, <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s, <a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m) =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ContractT">ContractT</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeRequest">FaeRequest</a> argType valType)) argType valType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s m (<a href="Blockchain-Fae-Internal-IDs-Types.html#t:EscrowID">EscrowID</a> argType valType)</li><li class="src short"><a href="#v:runFaeContract">runFaeContract</a> :: <a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a> -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> m a -&gt; m a</li><li class="src short"><a href="#v:hoistFaeContract">hoistFaeContract</a> :: (<a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m, <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s) =&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s m a</li><li class="src short"><a href="#v:liftFaeContract">liftFaeContract</a> :: (<a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m, <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s) =&gt; m a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s m a</li></ul></div><div id="interface"><h1 id="g:1">Types</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Escrows" class="def">Escrows</a> <a href="src/Blockchain.Fae.Internal.Contract.html#Escrows" class="link">Source</a> <a href="#t:Escrows" class="selflink">#</a></p><div class="doc"><p>How escrows are kept in each contract.  Contracts track their escrow
 ID sequence separately to prevent coupling between different ones.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Escrows" class="def">Escrows</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:escrowMap" class="def">escrowMap</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:EscrowMap">EscrowMap</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:nextID" class="def">nextID</a> :: <a href="Blockchain-Fae-Internal-IDs-Types.html#t:EntryID">EntryID</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Escrows" class="caption collapser" onclick="toggleSection('i:Escrows')">Instances</p><div id="section.i:Escrows" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Escrows:Generic:1" class="instance expander" onclick="toggleSection('i:id:Escrows:Generic:1')"></span> <a href="Blockchain-Fae.html#t:Generic">Generic</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a></span> <a href="src/Blockchain.Fae.Internal.Contract.html#line-85" class="link">Source</a> <a href="#t:Escrows" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Escrows:Generic:1" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> :: <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> -&gt; <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> <a href="#t:Rep" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> -&gt; <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> x <a href="#v:from" class="selflink">#</a></p><p class="src"><a href="#v:to">to</a> :: <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> x -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> <a href="#v:to" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Escrows:MonadTX:2" class="instance expander" onclick="toggleSection('i:id:Escrows:MonadTX:2')"></span> <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="Blockchain-Fae.html#t:MonadTX">MonadTX</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s)</span> <a href="src/Blockchain.Fae.html#line-188" class="link">Source</a> <a href="#t:MonadTX" class="selflink">#</a></td><td class="doc"><p>A little backwards, since <code><a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a></code> lies below rather than above
 <code><a href="Blockchain-Fae.html#t:FaeTX">FaeTX</a></code>, but they are actually isomorphic, and we need to start the
 monad stack down here so that we can derive <code>forall s. (Functor s) =&gt;
 MonadTX (FaeM s)</code>. </p></td></tr><tr><td colspan="2"><div id="section.i:id:Escrows:MonadTX:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftTX">liftTX</a> :: <a href="Blockchain-Fae.html#t:FaeTX">FaeTX</a> a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s a</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Escrows:Rep:3" class="instance expander" onclick="toggleSection('i:id:Escrows:Rep:3')"></span> <span class="keyword">type</span> <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a></span> <a href="src/Blockchain.Fae.Internal.Contract.html#line-1" class="link">Source</a> <a href="#t:Escrows" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Escrows:Rep:3" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="../base-4.10.0.0/GHC-Generics.html#t:Rep">Rep</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> = <a href="../base-4.10.0.0/GHC-Generics.html#t:D1">D1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaData">MetaData</a> &quot;Escrows&quot; &quot;Blockchain.Fae.Internal.Contract&quot; &quot;fae-0.9.9.9-6AAsItmAQePaeCp9CuAbn&quot; <a href="../base-4.10.0.0/Data-Bool.html#v:False">False</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t:C1">C1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaCons">MetaCons</a> &quot;Escrows&quot; <a href="../base-4.10.0.0/GHC-Generics.html#v:PrefixI">PrefixI</a> <a href="../base-4.10.0.0/Data-Bool.html#v:True">True</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t::-42-:">(:*:)</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#t:S1">S1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaSel">MetaSel</a> (<a href="../base-4.10.0.0/Data-Maybe.html#v:Just">Just</a> <a href="../base-4.10.0.0/GHC-TypeLits.html#t:Symbol">Symbol</a> &quot;escrowMap&quot;) <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceUnpackedness">NoSourceUnpackedness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceStrictness">NoSourceStrictness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:DecidedLazy">DecidedLazy</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t:Rec0">Rec0</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> <a href="Blockchain-Fae-Internal-Contract.html#t:EscrowMap">EscrowMap</a>)) (<a href="../base-4.10.0.0/GHC-Generics.html#t:S1">S1</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> (<a href="../base-4.10.0.0/GHC-Generics.html#v:MetaSel">MetaSel</a> (<a href="../base-4.10.0.0/Data-Maybe.html#v:Just">Just</a> <a href="../base-4.10.0.0/GHC-TypeLits.html#t:Symbol">Symbol</a> &quot;nextID&quot;) <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceUnpackedness">NoSourceUnpackedness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:NoSourceStrictness">NoSourceStrictness</a> <a href="../base-4.10.0.0/GHC-Generics.html#v:DecidedLazy">DecidedLazy</a>) (<a href="../base-4.10.0.0/GHC-Generics.html#t:Rec0">Rec0</a> <a href="../base-4.10.0.0/Data-Kind.html#t:-42-">*</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:EntryID">EntryID</a>))))</div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:EscrowMap" class="def">EscrowMap</a> = <a href="../containers-0.5.10.2/Data-Map-Internal.html#t:Map">Map</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:EntryID">EntryID</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:AbstractEscrow">AbstractEscrow</a>, <a href="Blockchain-Fae-Internal-IDs-Types.html#t:VersionID">VersionID</a>) <a href="src/Blockchain.Fae.Internal.Contract.html#EscrowMap" class="link">Source</a> <a href="#t:EscrowMap" class="selflink">#</a></p><div class="doc"><p>Convenience type.  Each escrow has a continually updated version that
 we need to track; this holds both for the escrow map of a contract and
 the escrows accompanying a returned value.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:WithEscrows" class="def">WithEscrows</a> a <a href="src/Blockchain.Fae.Internal.Contract.html#WithEscrows" class="link">Source</a> <a href="#t:WithEscrows" class="selflink">#</a></p><div class="doc"><p>This type encodes a value together with its backing escrows.  It is
 constructed automatically, and you can't construct it manually, so it is
 only useful in type signatures; it forces contracts to return values
 only via <code>spend</code> and <code>release</code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:WithEscrows" class="def">WithEscrows</a> <a href="Blockchain-Fae-Internal-Contract.html#t:EscrowMap">EscrowMap</a> a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:WithEscrows" class="caption collapser" onclick="toggleSection('i:WithEscrows')">Instances</p><div id="section.i:WithEscrows" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:WithEscrows:MonadContract:1" class="instance expander" onclick="toggleSection('i:id:WithEscrows:MonadContract:1')"></span> (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType) =&gt; <a href="Blockchain-Fae.html#t:MonadContract">MonadContract</a> argType valType (<a href="Blockchain-Fae.html#t:Fae">Fae</a> argType valType)</span> <a href="src/Blockchain.Fae.html#line-179" class="link">Source</a> <a href="#t:MonadContract" class="selflink">#</a></td><td class="doc"><p>Of course</p></td></tr><tr><td colspan="2"><div id="section.i:id:WithEscrows:MonadContract:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftContract">liftContract</a> :: <a href="Blockchain-Fae.html#t:Fae">Fae</a> argType valType a -&gt; <a href="Blockchain-Fae.html#t:Fae">Fae</a> argType valType a</p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FaeRequest" class="def">FaeRequest</a> argType valType = <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine-SuspensionFunctors.html#t:Request">Request</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> valType) (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> argType) <a href="src/Blockchain.Fae.Internal.Contract.html#FaeRequest" class="link">Source</a> <a href="#t:FaeRequest" class="selflink">#</a></p><div class="doc"><p>The <code><a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine-SuspensionFunctors.html#t:Request">Request</a></code> type is backwards for my visualization of contracts as
 coroutines, and also needs to be augmented with backing escrows.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FaeRWT" class="def">FaeRWT</a> m = <a href="../mtl-2.2.1/Control-Monad-Writer-Lazy.html#t:WriterT">WriterT</a> [<a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a>] (<a href="../mtl-2.2.1/Control-Monad-Reader.html#t:ReaderT">ReaderT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:TXData">TXData</a> m) <a href="src/Blockchain.Fae.Internal.Contract.html#FaeRWT" class="link">Source</a> <a href="#t:FaeRWT" class="selflink">#</a></p><div class="doc"><p>This monad contains everything that relates a contract to its
 surrounding transaction.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FaeRW" class="def">FaeRW</a> = <a href="Blockchain-Fae-Internal-Contract.html#t:FaeRWT">FaeRWT</a> <a href="Blockchain-Fae.html#t:Identity">Identity</a> <a href="src/Blockchain.Fae.Internal.Contract.html#FaeRW" class="link">Source</a> <a href="#t:FaeRW" class="selflink">#</a></p><div class="doc"><p>The commonly used variant</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TXData" class="def">TXData</a> <a href="src/Blockchain.Fae.Internal.Contract.html#TXData" class="link">Source</a> <a href="#t:TXData" class="selflink">#</a></p><div class="doc"><p>The relevant transaction info</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TXData" class="def">TXData</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:txSigners" class="def">txSigners</a> :: <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:thisTXID" class="def">thisTXID</a> :: <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:TXData" class="caption collapser" onclick="toggleSection('i:TXData')">Instances</p><div id="section.i:TXData" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:TXData:MonadTX:1" class="instance expander" onclick="toggleSection('i:id:TXData:MonadTX:1')"></span> <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="Blockchain-Fae.html#t:MonadTX">MonadTX</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s)</span> <a href="src/Blockchain.Fae.html#line-188" class="link">Source</a> <a href="#t:MonadTX" class="selflink">#</a></td><td class="doc"><p>A little backwards, since <code><a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a></code> lies below rather than above
 <code><a href="Blockchain-Fae.html#t:FaeTX">FaeTX</a></code>, but they are actually isomorphic, and we need to start the
 monad stack down here so that we can derive <code>forall s. (Functor s) =&gt;
 MonadTX (FaeM s)</code>. </p></td></tr><tr><td colspan="2"><div id="section.i:id:TXData:MonadTX:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftTX">liftTX</a> :: <a href="Blockchain-Fae.html#t:FaeTX">FaeTX</a> a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s a</p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FaeContractT" class="def">FaeContractT</a> s m = <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Coroutine">Coroutine</a> s (<a href="../mtl-2.2.1/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeRWT">FaeRWT</a> m)) <a href="src/Blockchain.Fae.Internal.Contract.html#FaeContractT" class="link">Source</a> <a href="#t:FaeContractT" class="selflink">#</a></p><div class="doc"><p>The actual contract monad builds on <code><a href="Blockchain-Fae-Internal-Contract.html#t:FaeRW">FaeRW</a></code> by adding escrows and
 continuation support.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FaeContract" class="def">FaeContract</a> s = <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s <a href="Blockchain-Fae.html#t:Identity">Identity</a> <a href="src/Blockchain.Fae.Internal.Contract.html#FaeContract" class="link">Source</a> <a href="#t:FaeContract" class="selflink">#</a></p><div class="doc"><p>The commonly used variant</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ContractT" class="def">ContractT</a> m argType valType = argType -&gt; m (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> valType) <a href="src/Blockchain.Fae.Internal.Contract.html#ContractT" class="link">Source</a> <a href="#t:ContractT" class="selflink">#</a></p><div class="doc"><p>A &quot;contract transformer&quot;.  The useful one is <code>ContractM</code>, though, in
 <a href="MonadFae.html">MonadFae</a>.</p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:FaeM" class="def">FaeM</a> s a <a href="src/Blockchain.Fae.Internal.Contract.html#FaeM" class="link">Source</a> <a href="#t:FaeM" class="selflink">#</a></p><div class="doc"><p>This wrapper is necessary because <code><a href="Blockchain-Fae-Internal-Contract.html#v:Fae">Fae</a></code> and <code>FaeTX</code> are monads that
 contract authors can actually use, and so we need to carefully limit the
 capabilities they are allowed.  It's here so we don't export it from
 <a href="Fae.html">Fae</a>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Fae" class="def">Fae</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:getFae" class="def">getFae</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:FaeM" class="caption collapser" onclick="toggleSection('i:FaeM')">Instances</p><div id="section.i:FaeM" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:FaeM:MonadContract:1" class="instance expander" onclick="toggleSection('i:id:FaeM:MonadContract:1')"></span> (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType) =&gt; <a href="Blockchain-Fae.html#t:MonadContract">MonadContract</a> argType valType (<a href="Blockchain-Fae.html#t:Fae">Fae</a> argType valType)</span> <a href="src/Blockchain.Fae.html#line-179" class="link">Source</a> <a href="#t:MonadContract" class="selflink">#</a></td><td class="doc"><p>Of course</p></td></tr><tr><td colspan="2"><div id="section.i:id:FaeM:MonadContract:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftContract">liftContract</a> :: <a href="Blockchain-Fae.html#t:Fae">Fae</a> argType valType a -&gt; <a href="Blockchain-Fae.html#t:Fae">Fae</a> argType valType a</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:FaeM:Monad:2" class="instance expander" onclick="toggleSection('i:id:FaeM:Monad:2')"></span> <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s)</span> <a href="src/Blockchain.Fae.Internal.Contract.html#line-126" class="link">Source</a> <a href="#t:FaeM" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:FaeM:Monad:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-62--62--61-">(&gt;&gt;=)</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a -&gt; (a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s b) -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s b <a href="#v:-62--62--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62--62-">(&gt;&gt;)</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s b -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s b <a href="#v:-62--62-" class="selflink">#</a></p><p class="src"><a href="#v:return">return</a> :: a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a <a href="#v:return" class="selflink">#</a></p><p class="src"><a href="#v:fail">fail</a> :: <a href="../base-4.10.0.0/Data-String.html#t:String">String</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a <a href="#v:fail" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:FaeM:Functor:3" class="instance expander" onclick="toggleSection('i:id:FaeM:Functor:3')"></span> <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s)</span> <a href="src/Blockchain.Fae.Internal.Contract.html#line-126" class="link">Source</a> <a href="#t:FaeM" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:FaeM:Functor:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s b -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a <a href="#v:-60--36-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:FaeM:Applicative:4" class="instance expander" onclick="toggleSection('i:id:FaeM:Applicative:4')"></span> <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="../base-4.10.0.0/Control-Applicative.html#t:Applicative">Applicative</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s)</span> <a href="src/Blockchain.Fae.Internal.Contract.html#line-126" class="link">Source</a> <a href="#t:FaeM" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:FaeM:Applicative:4" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:pure">pure</a> :: a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a <a href="#v:pure" class="selflink">#</a></p><p class="src"><a href="#v:-60--42--62-">(&lt;*&gt;)</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s (a -&gt; b) -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s b <a href="#v:-60--42--62-" class="selflink">#</a></p><p class="src"><a href="#v:liftA2">liftA2</a> :: (a -&gt; b -&gt; c) -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s b -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s c <a href="#v:liftA2" class="selflink">#</a></p><p class="src"><a href="#v:-42--62-">(*&gt;)</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s b -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s b <a href="#v:-42--62-" class="selflink">#</a></p><p class="src"><a href="#v:-60--42-">(&lt;*)</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s b -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a <a href="#v:-60--42-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:FaeM:MonadTX:5" class="instance expander" onclick="toggleSection('i:id:FaeM:MonadTX:5')"></span> <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="Blockchain-Fae.html#t:MonadTX">MonadTX</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s)</span> <a href="src/Blockchain.Fae.html#line-192" class="link">Source</a> <a href="#t:MonadTX" class="selflink">#</a></td><td class="doc"><p>Of course</p></td></tr><tr><td colspan="2"><div id="section.i:id:FaeM:MonadTX:5" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftTX">liftTX</a> :: <a href="Blockchain-Fae.html#t:FaeTX">FaeTX</a> a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeM">FaeM</a> s a</p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:InternalT" class="def">InternalT</a> s argType valType = <a href="Blockchain-Fae-Internal-Contract.html#t:ContractT">ContractT</a> (<a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Coroutine">Coroutine</a> s <a href="Blockchain-Fae-Internal-Contract.html#t:FaeRW">FaeRW</a>) argType valType <a href="src/Blockchain.Fae.Internal.Contract.html#InternalT" class="link">Source</a> <a href="#t:InternalT" class="selflink">#</a></p><div class="doc"><p>An internal representation of a contract, partway through full
 &quot;compilation&quot;.  An <code><a href="Blockchain-Fae-Internal-Contract.html#t:InternalT">InternalT</a></code> has its escrows hidden, because it will
 need to be evaluated inside a <em>different</em> <code><a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a></code> monad that has
 its own escrows that shouldn't interfere.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:InternalContract" class="def">InternalContract</a> argType valType = <a href="Blockchain-Fae-Internal-Contract.html#t:InternalT">InternalT</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeRequest">FaeRequest</a> argType valType) (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> argType) valType <a href="src/Blockchain.Fae.Internal.Contract.html#InternalContract" class="link">Source</a> <a href="#t:InternalContract" class="selflink">#</a></p><div class="doc"><p>Similar to a <code>Contract</code>, but accepts an escrow-endowed value and
 doesn't expose its escrows.</p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:ConcreteContract" class="def">ConcreteContract</a> argType valType <a href="src/Blockchain.Fae.Internal.Contract.html#ConcreteContract" class="link">Source</a> <a href="#t:ConcreteContract" class="selflink">#</a></p><div class="doc"><p>A contract is, abstractly, a function that can be called in any Fae
 context, producing a value and a continuation.  The return-type monad is
 a <code><a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a></code> rather than just a <code><a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a></code> because contracts
 (and, potentially, escrows) will be run in the former when it is not the
 latter.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ConcreteContract" class="def">ConcreteContract</a> (<span class="keyword">forall</span> s m. (<a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s, <a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m) =&gt; argType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s m (<a href="../base-4.10.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> argType valType), valType))</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:ConcreteContract" class="caption collapser" onclick="toggleSection('i:ConcreteContract')">Instances</p><div id="section.i:ConcreteContract" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:ConcreteContract:MonadTX:1" class="instance expander" onclick="toggleSection('i:id:ConcreteContract:MonadTX:1')"></span> <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="Blockchain-Fae.html#t:MonadTX">MonadTX</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s)</span> <a href="src/Blockchain.Fae.html#line-188" class="link">Source</a> <a href="#t:MonadTX" class="selflink">#</a></td><td class="doc"><p>A little backwards, since <code><a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a></code> lies below rather than above
 <code><a href="Blockchain-Fae.html#t:FaeTX">FaeTX</a></code>, but they are actually isomorphic, and we need to start the
 monad stack down here so that we can derive <code>forall s. (Functor s) =&gt;
 MonadTX (FaeM s)</code>. </p></td></tr><tr><td colspan="2"><div id="section.i:id:ConcreteContract:MonadTX:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftTX">liftTX</a> :: <a href="Blockchain-Fae.html#t:FaeTX">FaeTX</a> a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s a</p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:AbstractEscrow" class="def">AbstractEscrow</a> = <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> <a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a> <a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a> <a href="src/Blockchain.Fae.Internal.Contract.html#AbstractEscrow" class="link">Source</a> <a href="#t:AbstractEscrow" class="selflink">#</a></p><div class="doc"><p>The type actually stored in the escrows map, because escrows can have
 any types of input and output.  Abstract escrows take arbitrary argument
 types.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:AbstractContract" class="def">AbstractContract</a> = <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> (<a href="../base-4.10.0.0/Data-String.html#t:String">String</a>, <a href="Blockchain-Fae-Internal-Versions.html#t:VersionMap">VersionMap</a>) (<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>, <a href="Blockchain-Fae-Internal-Versions.html#t:VersionMap">VersionMap</a>) <a href="src/Blockchain.Fae.Internal.Contract.html#AbstractContract" class="link">Source</a> <a href="#t:AbstractContract" class="selflink">#</a></p><div class="doc"><p>The type actually stored in a <code><a href="Blockchain-Fae-Internal-Storage.html#v:TransactionEntry">TransactionEntry</a></code>, because contracts
 can have any types of input and output.  Abstract contracts only take
 string inputs, which they have to parse into the argument type they
 expect.  This prevents malicious users from injecting their own code
 into transactions' contract calls.</p></div></div><h1 id="g:2">Template Haskell</h1><div class="top"><p class="src"><a id="v:_nextID" class="def">_nextID</a> :: <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:EntryID">EntryID</a> <a href="src/Blockchain.Fae.Internal.Contract.html#line-167" class="link">Source</a> <a href="#v:_nextID" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_escrowMap" class="def">_escrowMap</a> :: <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> <a href="Blockchain-Fae-Internal-Contract.html#t:EscrowMap">EscrowMap</a> <a href="src/Blockchain.Fae.Internal.Contract.html#line-167" class="link">Source</a> <a href="#v:_escrowMap" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_txSigners" class="def">_txSigners</a> :: <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> <a href="Blockchain-Fae-Internal-Contract.html#t:TXData">TXData</a> <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> <a href="src/Blockchain.Fae.Internal.Contract.html#line-168" class="link">Source</a> <a href="#v:_txSigners" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:_thisTXID" class="def">_thisTXID</a> :: <a href="../lens-4.15.4/Control-Lens-Type.html#t:Lens-39-">Lens'</a> <a href="Blockchain-Fae-Internal-Contract.html#t:TXData">TXData</a> <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a> <a href="src/Blockchain.Fae.Internal.Contract.html#line-168" class="link">Source</a> <a href="#v:_thisTXID" class="selflink">#</a></p></div><h1 id="g:3">Functions</h1><div class="top"><p class="src"><a id="v:makeInternalT" class="def">makeInternalT</a> :: (<a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s, <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s', <a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m) =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ContractT">ContractT</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s') argType valType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s m (<a href="Blockchain-Fae-Internal-Contract.html#t:InternalT">InternalT</a> s' (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> argType) valType) <a href="src/Blockchain.Fae.Internal.Contract.html#makeInternalT" class="link">Source</a> <a href="#v:makeInternalT" class="selflink">#</a></p><div class="doc"><p>Processes a <code>Contract</code> so that it can take escrows on the first call,
 and hides the escrow storage.</p></div></div><div class="top"><p class="src"><a id="v:makeConcrete" class="def">makeConcrete</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType) =&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:InternalContract">InternalContract</a> argType valType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> argType valType <a href="src/Blockchain.Fae.Internal.Contract.html#makeConcrete" class="link">Source</a> <a href="#v:makeConcrete" class="selflink">#</a></p><div class="doc"><p>Takes care of running the contract coroutine and extracting the
 continuation.  It also correctly retrieves escrows from the argument and
 places the escrows of the return value into the local storage.</p></div></div><div class="top"><p class="src"><a id="v:makeEscrowAbstract" class="def">makeEscrowAbstract</a> :: <span class="keyword">forall</span> argType valType. (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType) =&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> argType valType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractEscrow">AbstractEscrow</a> <a href="src/Blockchain.Fae.Internal.Contract.html#makeEscrowAbstract" class="link">Source</a> <a href="#v:makeEscrowAbstract" class="selflink">#</a></p><div class="doc"><p>An abstract escrow just needs to check the type of its input and clear
 the type of its output.  The <code><a href="Blockchain-Fae-Internal-Contract.html#t:AbstractEscrow">AbstractEscrow</a></code> result does not force its
 return value.</p></div></div><div class="top"><p class="src"><a id="v:makeContractAbstract" class="def">makeContractAbstract</a> :: <span class="keyword">forall</span> argType valType. (<a href="../base-4.10.0.0/Text-Read.html#t:Read">Read</a> argType, <a href="Blockchain-Fae-Internal-NFData.html#t:NFData">NFData</a> valType, <a href="Blockchain-Fae-Internal-Versions.html#t:Versionable">Versionable</a> argType, <a href="Blockchain-Fae-Internal-Versions.html#t:Versionable">Versionable</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType) =&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> argType valType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a> <a href="src/Blockchain.Fae.Internal.Contract.html#makeContractAbstract" class="link">Source</a> <a href="#v:makeContractAbstract" class="selflink">#</a></p><div class="doc"><p>An abstract contract needs to parse its input, clear the
 output type, and also resolve version IDs in the input and save new
 versions in the output.  The <code><a href="Blockchain-Fae-Internal-Contract.html#t:AbstractContract">AbstractContract</a></code> result deeply forces its
 return value.</p></div></div><div class="top"><p class="src"><a id="v:unmakeAbstractEscrow" class="def">unmakeAbstractEscrow</a> :: <span class="keyword">forall</span> argType valType. (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType) =&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:AbstractEscrow">AbstractEscrow</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ConcreteContract">ConcreteContract</a> argType valType <a href="src/Blockchain.Fae.Internal.Contract.html#unmakeAbstractEscrow" class="link">Source</a> <a href="#v:unmakeAbstractEscrow" class="selflink">#</a></p><div class="doc"><p>Because when we call an escrow, we actually know exactly what type was
 given as its argument and expected as its result.</p></div></div><div class="top"><p class="src"><a id="v:takeEscrows" class="def">takeEscrows</a> :: <a href="../adjunctions-4.3/Control-Monad-Representable-State.html#t:MonadState">MonadState</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> m =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; m <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> <a href="src/Blockchain.Fae.Internal.Contract.html#takeEscrows" class="link">Source</a> <a href="#v:takeEscrows" class="selflink">#</a></p><div class="doc"><p>Retrieves backing escrows from value-bearing objects.</p></div></div><div class="top"><p class="src"><a id="v:getEscrowMap" class="def">getEscrowMap</a> :: <span class="keyword">forall</span> m. <a href="../adjunctions-4.3/Control-Monad-Representable-State.html#t:MonadState">MonadState</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> m =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; m <a href="Blockchain-Fae-Internal-Contract.html#t:EscrowMap">EscrowMap</a> <a href="src/Blockchain.Fae.Internal.Contract.html#getEscrowMap" class="link">Source</a> <a href="#v:getEscrowMap" class="selflink">#</a></p><div class="doc"><p>Just concatenates the list of all escrows in each of the objects, then
 turns it into a map.  Internally, this uses an imiation of the <code>lens</code>
 function <code>toList</code> for <code><a href="../lens-4.15.4/Control-Lens-Type.html#t:Traversal">Traversal</a></code>s, but since an <code><a href="Blockchain-Fae-Internal-IDs.html#t:EscrowIDTraversal">EscrowIDTraversal</a></code> is
 not <em>exactly</em> a <code><a href="../lens-4.15.4/Control-Lens-Type.html#t:Traversal">Traversal</a></code>, we have to reproduce it.</p></div></div><div class="top"><p class="src"><a id="v:takeEscrow" class="def">takeEscrow</a> :: <a href="../adjunctions-4.3/Control-Monad-Representable-State.html#t:MonadState">MonadState</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> m =&gt; <a href="Blockchain-Fae-Internal-IDs-Types.html#t:EscrowID">EscrowID</a> argType valType -&gt; m (<a href="Blockchain-Fae-Internal-IDs-Types.html#t:EntryID">EntryID</a>, (<a href="Blockchain-Fae-Internal-Contract.html#t:AbstractEscrow">AbstractEscrow</a>, <a href="Blockchain-Fae-Internal-IDs-Types.html#t:VersionID">VersionID</a>)) <a href="src/Blockchain.Fae.Internal.Contract.html#takeEscrow" class="link">Source</a> <a href="#v:takeEscrow" class="selflink">#</a></p><div class="doc"><p>Actually looks up an escrow by ID.  This function actually
 <em>takes</em> the escrows, not just copies them, because valuable things can't
 be copied.</p></div></div><div class="top"><p class="src"><a id="v:internalSpend" class="def">internalSpend</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType, <a href="../adjunctions-4.3/Control-Monad-Representable-State.html#t:MonadState">MonadState</a> <a href="Blockchain-Fae-Internal-Contract.html#t:Escrows">Escrows</a> m) =&gt; valType -&gt; m (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> valType) <a href="src/Blockchain.Fae.Internal.Contract.html#internalSpend" class="link">Source</a> <a href="#v:internalSpend" class="selflink">#</a></p><div class="doc"><p>Because we need to essentially <code>spend</code> a value internally, and we
 haven't defined that function yet.</p></div></div><div class="top"><p class="src"><a id="v:internalNewEscrow" class="def">internalNewEscrow</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType, <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s, <a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m) =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:ContractT">ContractT</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeRequest">FaeRequest</a> argType valType)) argType valType -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s m (<a href="Blockchain-Fae-Internal-IDs-Types.html#t:EscrowID">EscrowID</a> argType valType) <a href="src/Blockchain.Fae.Internal.Contract.html#internalNewEscrow" class="link">Source</a> <a href="#v:internalNewEscrow" class="selflink">#</a></p><div class="doc"><p>Because in <a href="Transaction.html">Transaction</a> we need to create a rewards escrow.</p></div></div><div class="top"><p class="src"><a id="v:runFaeContract" class="def">runFaeContract</a> :: <a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Blockchain-Fae-Internal-IDs-Types.html#t:TransactionID">TransactionID</a> -&gt; <a href="Blockchain-Fae-Internal-Storage.html#t:Signers">Signers</a> -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> m a -&gt; m a <a href="src/Blockchain.Fae.Internal.Contract.html#runFaeContract" class="link">Source</a> <a href="#v:runFaeContract" class="selflink">#</a></p><div class="doc"><p>A summary monad-running function.  You start with no escrows and the
 next escrow ID is the transaction ID.</p></div></div><div class="top"><p class="src"><a id="v:hoistFaeContract" class="def">hoistFaeContract</a> :: (<a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m, <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s) =&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s m a <a href="src/Blockchain.Fae.Internal.Contract.html#hoistFaeContract" class="link">Source</a> <a href="#v:hoistFaeContract" class="selflink">#</a></p><div class="doc"><p>Boosts the base monad from <code><a href="Blockchain-Fae.html#t:Identity">Identity</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:liftFaeContract" class="def">liftFaeContract</a> :: (<a href="../base-4.10.0.0/Control-Monad.html#t:Monad">Monad</a> m, <a href="../base-4.10.0.0/Data-Functor.html#t:Functor">Functor</a> s) =&gt; m a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContractT">FaeContractT</a> s m a <a href="src/Blockchain.Fae.Internal.Contract.html#liftFaeContract" class="link">Source</a> <a href="#v:liftFaeContract" class="selflink">#</a></p><div class="doc"><p>Goes all the way up the rather long monad stack.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.18.1</p></div></body></html>