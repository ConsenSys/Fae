<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Blockchain.Fae.Internal.MonadFae</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Blockchain-Fae-Internal-MonadFae.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Blockchain.Fae.Internal.MonadFae.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">fae-0.9.1.0</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Ryan Reich 2017</td></tr><tr><th>License</th><td>MIT</td></tr><tr><th>Maintainer</th><td>ryan.reich@gmail.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Blockchain.Fae.Internal.MonadFae</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Types</a></li><li><a href="#g:2">Type classes</a></li><li><a href="#g:3">Functions</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module provides a clean, minimal API for contract authoring.  The <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a></code> and <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadContract">MonadContract</a></code> classes exist to facilitate using monad transformers on top of the base <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a></code> monad when defining contracts.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">newtype</span> <a href="#t:FaeM">FaeM</a> s a = <a href="#v:Fae">Fae</a> {<ul class="subs"><li><a href="#v:getFae">getFae</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s a</li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:Fae">Fae</a> argType valType = <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeRequest">FaeRequest</a> argType valType)</li><li class="src short"><span class="keyword">type</span> <a href="#t:FaeTX">FaeTX</a> = <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Contract">Contract</a> argType valType = <a href="Blockchain-Fae-Internal-Contract.html#t:ContractT">ContractT</a> (<a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a> argType valType) argType valType</li><li class="src short"><span class="keyword">class</span> (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m) =&gt; <a href="#t:MonadContract">MonadContract</a> argType valType m | m -&gt; argType valType <span class="keyword">where</span><ul class="subs"></ul></li><li class="src short"><span class="keyword">class</span> <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="#t:MonadTX">MonadTX</a> m <span class="keyword">where</span><ul class="subs"></ul></li><li class="src short"><a href="#v:spend">spend</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadContract">MonadContract</a> argType' valType' m) =&gt; valType -&gt; m (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> valType)</li><li class="src short"><a href="#v:release">release</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadContract">MonadContract</a> argType valType m) =&gt; valType -&gt; m argType</li><li class="src short"><a href="#v:useEscrow">useEscrow</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m) =&gt; <a href="Blockchain-Fae-Internal-IDs.html#t:EscrowID">EscrowID</a> argType valType -&gt; argType -&gt; m valType</li><li class="src short"><a href="#v:newEscrow">newEscrow</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m) =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:Contract">Contract</a> argType valType -&gt; m (<a href="Blockchain-Fae-Internal-IDs.html#t:EscrowID">EscrowID</a> argType valType)</li><li class="src short"><a href="#v:newContract">newContract</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Versions.html#t:Versionable">Versionable</a> argType, <a href="Blockchain-Fae-Internal-Versions.html#t:Versionable">Versionable</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType, <a href="../base-4.9.1.0/Text-Read.html#t:Read">Read</a> argType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m) =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:Contract">Contract</a> argType valType -&gt; m ()</li><li class="src short"><a href="#v:lookupSigner">lookupSigner</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m =&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; m (<a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a>)</li><li class="src short"><a href="#v:signer">signer</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m =&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; m <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a></li></ul></div><div id="interface"><h1 id="g:1">Types</h1><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:FaeM" class="def">FaeM</a> s a <a href="src/Blockchain.Fae.Internal.MonadFae.html#FaeM" class="link">Source</a> <a href="#t:FaeM" class="selflink">#</a></p><div class="doc"><p>This wrapper is necessary because <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a></code> and <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeTX">FaeTX</a></code> are monads that
 contract authors can actually use, and so we need to carefully limit the
 capabilities they are allowed.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Fae" class="def">Fae</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:getFae" class="def">getFae</a> :: <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:FaeM" class="caption collapser" onclick="toggleSection('i:FaeM')">Instances</p><div id="section.i:FaeM" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:FaeM:MonadContract:1" class="instance expander" onclick="toggleSection('i:id:FaeM:MonadContract:1')"></span> (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType) =&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadContract">MonadContract</a> argType valType (<a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a> argType valType)</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#line-96" class="link">Source</a> <a href="#t:FaeM" class="selflink">#</a></td><td class="doc"><p>Of course</p></td></tr><tr><td colspan="2"><div id="section.i:id:FaeM:MonadContract:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftContract">liftContract</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a> argType valType a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a> argType valType a <a href="src/Blockchain.Fae.Internal.MonadFae.html#liftContract" class="link">Source</a> <a href="#v:liftContract" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:FaeM:Monad:2" class="instance expander" onclick="toggleSection('i:id:FaeM:Monad:2')"></span> <a href="../base-4.9.1.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> (<a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s)</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#line-41" class="link">Source</a> <a href="#t:FaeM" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:FaeM:Monad:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-62--62--61-">(&gt;&gt;=)</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a -&gt; (a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s b) -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s b <a href="#v:-62--62--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62--62-">(&gt;&gt;)</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s b -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s b <a href="#v:-62--62-" class="selflink">#</a></p><p class="src"><a href="#v:return">return</a> :: a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a <a href="#v:return" class="selflink">#</a></p><p class="src"><a href="#v:fail">fail</a> :: <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a <a href="#v:fail" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:FaeM:Functor:3" class="instance expander" onclick="toggleSection('i:id:FaeM:Functor:3')"></span> <a href="../base-4.9.1.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="../base-4.9.1.0/Data-Functor.html#t:Functor">Functor</a> (<a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s)</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#line-41" class="link">Source</a> <a href="#t:FaeM" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:FaeM:Functor:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s b -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a <a href="#v:-60--36-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:FaeM:Applicative:4" class="instance expander" onclick="toggleSection('i:id:FaeM:Applicative:4')"></span> <a href="../base-4.9.1.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="../base-4.9.1.0/Control-Applicative.html#t:Applicative">Applicative</a> (<a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s)</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#line-41" class="link">Source</a> <a href="#t:FaeM" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:FaeM:Applicative:4" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:pure">pure</a> :: a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a <a href="#v:pure" class="selflink">#</a></p><p class="src"><a href="#v:-60--42--62-">(&lt;*&gt;)</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s (a -&gt; b) -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s b <a href="#v:-60--42--62-" class="selflink">#</a></p><p class="src"><a href="#v:-42--62-">(*&gt;)</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s b -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s b <a href="#v:-42--62-" class="selflink">#</a></p><p class="src"><a href="#v:-60--42-">(&lt;*)</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s b -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a <a href="#v:-60--42-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:FaeM:MonadTX:5" class="instance expander" onclick="toggleSection('i:id:FaeM:MonadTX:5')"></span> <a href="../base-4.9.1.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> (<a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s)</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#line-109" class="link">Source</a> <a href="#t:FaeM" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:FaeM:MonadTX:5" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftTX">liftTX</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeTX">FaeTX</a> a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a <a href="src/Blockchain.Fae.Internal.MonadFae.html#liftTX" class="link">Source</a> <a href="#v:liftTX" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Fae" class="def">Fae</a> argType valType = <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeRequest">FaeRequest</a> argType valType) <a href="src/Blockchain.Fae.Internal.MonadFae.html#Fae" class="link">Source</a> <a href="#t:Fae" class="selflink">#</a></p><div class="doc"><p>The monad for multi-stage contracts taking an <code>argType</code> and returning
 a <code>valType</code>.  These may not be transactions.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FaeTX" class="def">FaeTX</a> = <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> <a href="../monad-coroutine-0.9.0.3/Control-Monad-Coroutine.html#t:Naught">Naught</a> <a href="src/Blockchain.Fae.Internal.MonadFae.html#FaeTX" class="link">Source</a> <a href="#t:FaeTX" class="selflink">#</a></p><div class="doc"><p>The monad for single-stage contracts, i.e. transactions.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Contract" class="def">Contract</a> argType valType = <a href="Blockchain-Fae-Internal-Contract.html#t:ContractT">ContractT</a> (<a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a> argType valType) argType valType <a href="src/Blockchain.Fae.Internal.MonadFae.html#Contract" class="link">Source</a> <a href="#t:Contract" class="selflink">#</a></p><div class="doc"><p>This is the type to use when defining a new contract.  Its argument is
 the argument given in the first call to this contract; all subsequent
 calls pass in their arguments via <code><a href="Blockchain-Fae-Internal-MonadFae.html#v:release">release</a></code>.</p></div></div><h1 id="g:2">Type classes</h1><div class="top"><p class="src"><span class="keyword">class</span> (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m) =&gt; <a id="t:MonadContract" class="def">MonadContract</a> argType valType m | m -&gt; argType valType <span class="keyword">where</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#MonadContract" class="link">Source</a> <a href="#t:MonadContract" class="selflink">#</a></p><div class="doc"><p>Instances of this class have access to the full Fae API, allowing them
 to define multi-stage contracts.  As for <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a></code>, these instances must
 have their own evaluation function to get down to the base <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a></code> monad.
 Notably, <code>Transaction</code>s are <em>not</em> written in a <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadContract">MonadContract</a></code>, because
 they are one-shot.</p></div><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src"><a href="Blockchain-Fae-Internal-MonadFae.html#v:liftContract">liftContract</a></p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:liftContract" class="def">liftContract</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a> argType valType a -&gt; m a <a href="src/Blockchain.Fae.Internal.MonadFae.html#liftContract" class="link">Source</a> <a href="#v:liftContract" class="selflink">#</a></p><div class="doc"><p>Injects the Fae contract API into <code>m</code>.</p></div></div><div class="subs instances"><p id="control.i:MonadContract" class="caption collapser" onclick="toggleSection('i:MonadContract')">Instances</p><div id="section.i:MonadContract" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:MonadContract:MonadContract:1" class="instance expander" onclick="toggleSection('i:ic:MonadContract:MonadContract:1')"></span> (<a href="../transformers-0.5.2.0/Control-Monad-Trans-Class.html#t:MonadTrans">MonadTrans</a> t, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadContract">MonadContract</a> argType valType m, <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> (t m)) =&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadContract">MonadContract</a> argType valType (t m)</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#line-82" class="link">Source</a> <a href="#t:MonadContract" class="selflink">#</a></td><td class="doc"><p>An <code>UndecidableInstance</code> for sure</p></td></tr><tr><td colspan="2"><div id="section.i:ic:MonadContract:MonadContract:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftContract">liftContract</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a> argType valType a -&gt; t m a <a href="src/Blockchain.Fae.Internal.MonadFae.html#liftContract" class="link">Source</a> <a href="#v:liftContract" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:MonadContract:MonadContract:2" class="instance expander" onclick="toggleSection('i:ic:MonadContract:MonadContract:2')"></span> (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType) =&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadContract">MonadContract</a> argType valType (<a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a> argType valType)</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#line-96" class="link">Source</a> <a href="#t:MonadContract" class="selflink">#</a></td><td class="doc"><p>Of course</p></td></tr><tr><td colspan="2"><div id="section.i:ic:MonadContract:MonadContract:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftContract">liftContract</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a> argType valType a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a> argType valType a <a href="src/Blockchain.Fae.Internal.MonadFae.html#liftContract" class="link">Source</a> <a href="#v:liftContract" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a id="t:MonadTX" class="def">MonadTX</a> m <span class="keyword">where</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#MonadTX" class="link">Source</a> <a href="#t:MonadTX" class="selflink">#</a></p><div class="doc"><p>Instances of this class may use the bulk of the Fae API; namely, they
 may hold value via escrows and create new contracts.  Such monads are
 intended to be defined by a transformer stack on top of <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeTX">FaeTX</a></code>, hence
 <code><a href="Blockchain-Fae-Internal-MonadFae.html#v:liftTX">liftTX</a></code>; to be useful, they must have a function that &quot;evaluates&quot; them
 down to <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:Fae">Fae</a></code> or <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeTX">FaeTX</a></code>, so they may define new transactions or
 contracts.</p></div><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src"><a href="Blockchain-Fae-Internal-MonadFae.html#v:liftTX">liftTX</a></p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:liftTX" class="def">liftTX</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeTX">FaeTX</a> a -&gt; m a <a href="src/Blockchain.Fae.Internal.MonadFae.html#liftTX" class="link">Source</a> <a href="#v:liftTX" class="selflink">#</a></p><div class="doc"><p>Injects the Fae transaction API into <code>m</code>.</p></div></div><div class="subs instances"><p id="control.i:MonadTX" class="caption collapser" onclick="toggleSection('i:MonadTX')">Instances</p><div id="section.i:MonadTX" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:MonadTX:MonadTX:1" class="instance expander" onclick="toggleSection('i:ic:MonadTX:MonadTX:1')"></span> (<a href="../transformers-0.5.2.0/Control-Monad-Trans-Class.html#t:MonadTrans">MonadTrans</a> t, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m, <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> (t m)) =&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> (t m)</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#line-89" class="link">Source</a> <a href="#t:MonadTX" class="selflink">#</a></td><td class="doc"><p>An <code>UndecidableInstance</code> for sure</p></td></tr><tr><td colspan="2"><div id="section.i:ic:MonadTX:MonadTX:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftTX">liftTX</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeTX">FaeTX</a> a -&gt; t m a <a href="src/Blockchain.Fae.Internal.MonadFae.html#liftTX" class="link">Source</a> <a href="#v:liftTX" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:MonadTX:MonadTX:2" class="instance expander" onclick="toggleSection('i:ic:MonadTX:MonadTX:2')"></span> <a href="../base-4.9.1.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> (<a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s)</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#line-105" class="link">Source</a> <a href="#t:MonadTX" class="selflink">#</a></td><td class="doc"><p>A little backwards, since <code><a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a></code> lies below rather than above
 <code><a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeTX">FaeTX</a></code>, but they are actually isomorphic, and we need to start the
 monad stack down here so that we can derive <code>forall s. (Functor s) =&gt;
 MonadTX (FaeM s)</code>. </p></td></tr><tr><td colspan="2"><div id="section.i:ic:MonadTX:MonadTX:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftTX">liftTX</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeTX">FaeTX</a> a -&gt; <a href="Blockchain-Fae-Internal-Contract.html#t:FaeContract">FaeContract</a> s a <a href="src/Blockchain.Fae.Internal.MonadFae.html#liftTX" class="link">Source</a> <a href="#v:liftTX" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:MonadTX:MonadTX:3" class="instance expander" onclick="toggleSection('i:ic:MonadTX:MonadTX:3')"></span> <a href="../base-4.9.1.0/Data-Functor.html#t:Functor">Functor</a> s =&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> (<a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s)</span> <a href="src/Blockchain.Fae.Internal.MonadFae.html#line-109" class="link">Source</a> <a href="#t:MonadTX" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:ic:MonadTX:MonadTX:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftTX">liftTX</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeTX">FaeTX</a> a -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:FaeM">FaeM</a> s a <a href="src/Blockchain.Fae.Internal.MonadFae.html#liftTX" class="link">Source</a> <a href="#v:liftTX" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><h1 id="g:3">Functions</h1><div class="top"><p class="src"><a id="v:spend" class="def">spend</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadContract">MonadContract</a> argType' valType' m) =&gt; valType -&gt; m (<a href="Blockchain-Fae-Internal-Contract.html#t:WithEscrows">WithEscrows</a> valType) <a href="src/Blockchain.Fae.Internal.MonadFae.html#spend" class="link">Source</a> <a href="#v:spend" class="selflink">#</a></p><div class="doc"><p>This function is like <code><a href="../base-4.9.1.0/Control-Monad.html#v:return">return</a></code> but also ensures that the returned
 value is passed with its backing escrows, maintaining its value.  Once
 a contract terminates with a <code><a href="Blockchain-Fae-Internal-MonadFae.html#v:spend">spend</a></code>, it is removed from storage.</p></div></div><div class="top"><p class="src"><a id="v:release" class="def">release</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadContract">MonadContract</a> argType valType m) =&gt; valType -&gt; m argType <a href="src/Blockchain.Fae.Internal.MonadFae.html#release" class="link">Source</a> <a href="#v:release" class="selflink">#</a></p><div class="doc"><p>This function is used in an expression like <code>nextArg &lt;- release
 currentValue</code> to suspend the current contract, simultaneously
 <code><a href="Blockchain-Fae-Internal-MonadFae.html#v:spend">spend</a></code>ing an intermediate value, and awaiting its next call to
 continue with the arg that was passed.</p></div></div><div class="top"><p class="src"><a id="v:useEscrow" class="def">useEscrow</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m) =&gt; <a href="Blockchain-Fae-Internal-IDs.html#t:EscrowID">EscrowID</a> argType valType -&gt; argType -&gt; m valType <a href="src/Blockchain.Fae.Internal.MonadFae.html#useEscrow" class="link">Source</a> <a href="#v:useEscrow" class="selflink">#</a></p><div class="doc"><p>Calls the given escrow by ID as a function.  This causes the escrow to
 be updated, and possibly deleted if it terminated with a <code><a href="Blockchain-Fae-Internal-MonadFae.html#v:spend">spend</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:newEscrow" class="def">newEscrow</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m) =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:Contract">Contract</a> argType valType -&gt; m (<a href="Blockchain-Fae-Internal-IDs.html#t:EscrowID">EscrowID</a> argType valType) <a href="src/Blockchain.Fae.Internal.MonadFae.html#newEscrow" class="link">Source</a> <a href="#v:newEscrow" class="selflink">#</a></p><div class="doc"><p>Registers a contract as a new escrow, returning its ID.  The argument
 is a list of Haskell values marked as &quot;bearers&quot; of escrow-backed Fae
 value; their backing escrows are transferred into the new escrow, so
 that the bearer is no longer valuable in the contract that calls this
 function.  The returned ID is completely determined by the contract in
 which the escrow is created.</p></div></div><div class="top"><p class="src"><a id="v:newContract" class="def">newContract</a> :: (<a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> argType, <a href="Blockchain-Fae-Internal-IDs.html#t:HasEscrowIDs">HasEscrowIDs</a> valType, <a href="Blockchain-Fae-Internal-Versions.html#t:Versionable">Versionable</a> argType, <a href="Blockchain-Fae-Internal-Versions.html#t:Versionable">Versionable</a> valType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> argType, <a href="Blockchain-Fae-Internal-Exceptions.html#t:Typeable">Typeable</a> valType, <a href="../base-4.9.1.0/Text-Read.html#t:Read">Read</a> argType, <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m) =&gt; [<a href="Blockchain-Fae-Internal-IDs.html#t:BearsValue">BearsValue</a>] -&gt; <a href="Blockchain-Fae-Internal-MonadFae.html#t:Contract">Contract</a> argType valType -&gt; m () <a href="src/Blockchain.Fae.Internal.MonadFae.html#newContract" class="link">Source</a> <a href="#v:newContract" class="selflink">#</a></p><div class="doc"><p>Registers a contract publicly, with the same interface as <code><a href="Blockchain-Fae-Internal-MonadFae.html#v:newEscrow">newEscrow</a></code>.
 Public contracts may only be called as transaction inputs with string
 literal arguments, which are parsed into the actual <code>argType</code> by the
 provided <code><a href="../base-4.9.1.0/Text-Read.html#t:Read">Read</a></code> instance.</p></div></div><div class="top"><p class="src"><a id="v:lookupSigner" class="def">lookupSigner</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m =&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; m (<a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a>) <a href="src/Blockchain.Fae.Internal.MonadFae.html#lookupSigner" class="link">Source</a> <a href="#v:lookupSigner" class="selflink">#</a></p><div class="doc"><p>Looks up a named signatory, maybe. </p></div></div><div class="top"><p class="src"><a id="v:signer" class="def">signer</a> :: <a href="Blockchain-Fae-Internal-MonadFae.html#t:MonadTX">MonadTX</a> m =&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; m <a href="Blockchain-Fae-Internal-Crypto.html#t:PublicKey">PublicKey</a> <a href="src/Blockchain.Fae.Internal.MonadFae.html#signer" class="link">Source</a> <a href="#v:signer" class="selflink">#</a></p><div class="doc"><p>Looks up a named signatory, or throws if not found.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>